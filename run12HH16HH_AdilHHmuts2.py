from NeuronModelClass import NeuronModel
from NrnHelper import *
import NrnHelper as nh
import matplotlib.pyplot as plt
import sys
from pathlib import Path
import numpy as np
from Na12HMMModel_TF import *
import Na12HMMModel_TF as tf
import os
import efel_feature_extractor as ef
from currentscape.currentscape import plot_currentscape
import logging
import pandas as pd
# import Document as doc
# import Tim_ng_functions as nf

sim_config_soma = {
                'section' : 'soma',
                'segment' : 0.5,
                'section_num': 0,
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'],
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                'ionic_concentrations' :["cai", "ki", "nai"]
                }

#################################################################################
#1
# sim_config_soma = {
                # 'section' : 'soma',
                # 'segment' : 0.5,
                # 'section_num': 0,
                # #'currents' : ['ina','ica','ik'],
                # 'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                # #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                # #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # #'currents'  : ['ihcn_Ih','ik_SKv3_1','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # 'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                # 'ionic_concentrations' :["cai", "ki", "nai"]
                # #'ionic_concentrations' :["ki", "nai"]
                # }
# 2
sim_config_ais = {
                'section' : 'axon',
                'segment' : 0.1,
                'section_num': 0,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                #'currents'  : ['ihcn_Ih','ik_SKv3_1','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
# 3
sim_config_basaldend = {
                'section' : 'dend',
                'segment' : 0.5,
                'section_num': 70,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                'currents'  : [], #dend (no Ih, no ik_SKv3_1)
                'current_names' : ['Ih','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :[]
                }
#4
sim_config_nexus = {
                'section' : 'apic',
                'segment' : 0,
                'section_num': 77,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['ik_SKv3_1'], #Nexus
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
#5
sim_config_apicaldend = {
                'section' : 'apic',
                'segment' : 0.5,
                'section_num': 90,
                # 'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ik_SKv3_1','ihcn_Ih'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                #'currents'  : ['ihcn_Ih','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # 'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
#################################################################################

def modify_dict_file(filename, changes):
  """
  Modifies values in a dictionary stored in a text file.

  Args:
      filename: The name of the text file containing the dictionary.
      changes: A dictionary containing key-value pairs where the key is the key to modify in the original dictionary and the value is the new value.

  Raises:
      ValueError: If the file cannot be opened or the content is not valid JSON.
  """

  try:
    # Open the file and read its content
    with open(filename, "r") as file:
      content = file.read()

    # Try to load the content as a dictionary
    try:
      data = eval(content)  # Assuming the file contains valid dictionary syntax
    except (NameError, SyntaxError):
      raise ValueError("Invalid dictionary format in the file.")

    # Modify values based on the provided changes dictionary
    for key, value in changes.items():
      if key not in data:
        print(f"Warning: Key '{key}' not found in the dictionary, skipping.")
      else:
        data[key] = value

    # Write the modified dictionary back to the file
    # with open(filename, "w") as file:
    #   file.write(repr(data))
    with open(filename, "w") as file:
      file.write(json.dumps(data, indent=2))  # Add indentation for readability (optional)

  except IOError as e:
    raise ValueError(f"Error opening or writing file: {e}")
  


  



root_path_out = './Plots/12HH16HH/6-October2024Model/2-R853Q_tuning_102524' ##path for saving your plots
if not os.path.exists(root_path_out): ##make directory if it doens't exist
        os.makedirs(root_path_out)


rbs_vshift = 13.5

filename12 = './params/na12annaTFHH.txt' ##12HH params file that you will update with values below in changesna12
filename12mut = './params/na12annaTFHHmut.txt' ##12HH params file that you will update with values below in changesna12
filename16 = './params/na16HH_TF.txt' ##16HH params file that you will update with values below in changesna16


## 1.2 HH params after re-fitting rbs_vshift 1.2. The rbs_vshift had weird inactivation curve that didn't bottom out at 0.
# changesna12={"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.00036615946706607756, "gms": 0.14082624570054866, "hmin": 0.008420778920829085, "mmin": 0.013671131800210966, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.941545585888373, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455}

## 1.2HH params newest after Kevin's inpurt. 12-16 gap closer to 5mV now.
changesna12={"Rd": 0.023204006298533603, "Rg": 0.015604498120126004, "Rb": 0.0925081211054913, "Ra": 0.23933332265451177, "a0s": 0.0005226303768198727, "gms": 0.14418575154491814, "hmin": 0.008449935591049326, "mmin": 0.01193016441163175, "qinf": 5.7593653647578105, "q10": 2.1532859986639186, "qg": 1.2968193480468215, "qd": 0.661199851452832, "qa1": 4.492758160759386, "smax": 3.5557932199839737, "sh": 8.358558450280716, "thinf": -47.8194205612529, "thi2": -79.6556083820085, "thi1": -62.40165437813537, "tha": -33.850064879126805, "vvs": 1.4255479951467982, "vvh": -55.33213046147061, "vhalfs": -40.89976480829731, "zetas": 13.403615755952343}

## 16HH mod file params can be changed below
changesna16 = {
        "sh": 8,
        "tha": -47+rbs_vshift,
        "qa": 7.2,
        "Ra": 0.4,
        "Rb": 0.124,
        "thi1": -61+rbs_vshift,
        "thi2": -61+rbs_vshift,
        "qd": 0.5,
        "qg": 1.5,
        "mmin": 0.02,  
        "hmin": 0.01,  
        "q10": 2,
        "Rg": 0.01,
        "Rd": 0.03,
        "thinf": -65+rbs_vshift,
        "qinf": 7,
        "vhalfs": -40+rbs_vshift,
        "a0s": 0.0003,
        "gms": 0.2,
        "zetas": 12,
        "smax": 10,
        "vvh": -58,
        "vvs": 2,
        "ar2": 1,
        #"ena": 55
        }

modify_dict_file(filename12, changesna12)
modify_dict_file(filename16, changesna16)


config_dict = {"sim_config_soma": sim_config_soma,
              "sim_config_ais": sim_config_ais,
              "sim_config_basaldend": sim_config_basaldend,
              "sim_config_nexus": sim_config_nexus,
              "sim_config_apicaldend": sim_config_apicaldend}

config_dict2={"sim_config_nexus": sim_config_nexus,
              "sim_config_apicaldend": sim_config_apicaldend}

config_dict3={"sim_config_soma": sim_config_soma}
# path = f'1-m1879t'
# config = sim_config_soma
# wt_fi = [0, 0, 0, 0, 1, 7, 9, 10, 11, 12, 13, 14, 14, 15, 16, 16, 17, 17, 18, 18, 19]
# het_fi = [0, 0, 0, 0, 1, 7, 9, 10, 11, 12, 13, 14, 15, 16, 16, 17, 17, 18, 19, 19, 20]

# wt_fi = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,4,4,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16]
# het_fi = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,4,4,4,5,5,6,6,6,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18]
# ko_fi = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,3,3,4,4,5,5,6,6,6,7,7,7,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20]
adilvariants={#"R119I":{"Rd": 0.024792787327947992, "Rg": 0.017318376156443285, "Rb": 0.02553829828208759, "Ra": 0.22520259311043583, "a0s": 0.0004533116535117397, "gms": 0.09244831229335844, "hmin": 0.016041298323659293, "mmin": 0.027499806586227034, "qinf": 5.508893295749497, "q10": 2.06887667799264, "qg": 0.7214807372546089, "qd": 0.7519910095710679, "qa1": 3.864128173715168, "smax": 6.827462517896313, "sh": 7.545629407725753, "thinf": -45.639443179484104, "thi2": -61.45030475358188, "thi1": -79.90702695128591, "tha": -27.953582557288904, "vvs": 0.884475962979501, "vvh": -59.658110506860154, "vhalfs": -37.378654784154, "zetas": 14.388715478299599},
# "L181F":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "D195G":{"Rd": 0.023992500231084762, "Rg": 0.012659026669807312, "Rb": 0.0818909773513245, "Ra": 0.14716403357562596, "a0s": 0.00038471731340908945, "gms": 0.2530456348014775, "hmin": 0.014831390525799185, "mmin": 0.022865416705772308, "qinf": 5.907235980724364, "q10": 1.5509943174740057, "qg": 1.9610468735297772, "qd": 0.5592157376292303, "qa1": 4.445110968150566, "smax": 11.208758346629075, "sh": 9.350513767150385, "thinf": -52.61366657140489, "thi2": -69.68248598332264, "thi1": -74.28715642018685, "tha": -31.67360446553334, "vvs": 0.4390826339034208, "vvh": -56.41288186981312, "vhalfs": -27.77112414409777, "zetas": 14.873715703829722},
# "A215E":{"Rd": 0.025617467928912365, "Rg": 0.016845560433940227, "Rb": 0.028614825505867733, "Ra": 0.23255473801213297, "a0s": 0.0003572332783010924, "gms": 0.25707909573789467, "hmin": 0.0054348559582643, "mmin": 0.020874190334819975, "qinf": 5.65013969822696, "q10": 2.2878400190103525, "qg": 0.10745090765318716, "qd": 0.7685052183442707, "qa1": 6.1280268507419215, "smax": 8.802462928413535, "sh": 6.558717680119388, "thinf": -52.60301821731167, "thi2": -43.4675109874544, "thi1": -60.888336863352556, "tha": -29.830280096185355, "vvs": 0.8113705382252894, "vvh": -54.834785882613666, "vhalfs": -43.07882423288173, "zetas": 14.803016715078625},
# "A215T":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "A263E":{"Rd": 0.02939328778413818, "Rg": 0.0190601952671071, "Rb": 0.13362154180946206, "Ra": 0.18458731447842106, "a0s": 0.00046015913998654457, "gms": 0.21106365557392445, "hmin": 0.009795187138481914, "mmin": 0.0016682716576615821, "qinf": 5.4954032525613155, "q10": 1.0728903299533121, "qg": 2.913767078312575, "qd": 0.7420537968910521, "qa1": 4.050918152864734, "smax": 11.038476916504122, "sh": 8.48026062601182, "thinf": -39.94280977895748, "thi2": -78.02201865367135, "thi1": -78.80199777091127, "tha": -31.426257205916393, "vvs": 2.80325133783626, "vvh": -47.370985916584004, "vhalfs": -21.45493838002633, "zetas": 7.01499161537327},
# "A263V":{"Rd": 0.015931351964116883, "Rg": 0.018992272919662833, "Rb": 0.009869982915903366, "Ra": 0.10109904396680172, "a0s": 0.000311552488986059, "gms": 0.2927781566505004, "hmin": 0.0014407096945126294, "mmin": 0.004057101621702944, "qinf": 7.158735266011113, "q10": 1.1869295023258766, "qg": 2.0929297332492203, "qd": 0.9687315186752704, "qa1": 6.723074792288996, "smax": 10.305548311639479, "sh": 6.835166905278095, "thinf": -44.429095086563684, "thi2": -69.36675571274736, "thi1": -75.68100137467101, "tha": -25.17046193767951, "vvs": 0.22691160023480966, "vvh": -57.746696492857446, "vhalfs": -40.63209921643396, "zetas": 14.97983507308774},
# "D343H":{"Rd": 0.020054391841353405, "Rg": 0.01674887758787637, "Rb": 0.07141928465146193, "Ra": 0.16719364051015156, "a0s": 0.000239118122459519, "gms": 0.1912158322216344, "hmin": 0.006737987101376981, "mmin": 0.02766439114101351, "qinf": 5.805935290114826, "q10": 2.6471833852142908, "qg": 0.7400134542820724, "qd": 0.9093110360728228, "qa1": 6.104998405992943, "smax": 5.527160376941494, "sh": 8.57938133296084, "thinf": -40.104887050581745, "thi2": -65.55806126155858, "thi1": -53.337858456809926, "tha": -25.709880191127674, "vvs": 0.21318988871236155, "vvh": -54.38957411679532, "vhalfs": -50.03263381383297, "zetas": 13.786560100614057},
# "Y428C":{"Rd": 0.025765759756637623, "Rg": 0.017781801382815533, "Rb": 0.024423482486796183, "Ra": 0.3522181715364381, "a0s": 0.0003908294064417769, "gms": 0.09059629179642203, "hmin": 8.810822310567772e-05, "mmin": 0.011523877017682283, "qinf": 5.931977768261252, "q10": 1.8216542525100088, "qg": 0.2926532996335055, "qd": 0.37633929299284186, "qa1": 4.6324268512365725, "smax": 2.7435355454017407, "sh": 9.938190450201338, "thinf": -47.5133651559217, "thi2": -77.65058456034494, "thi1": -61.41108657208064, "tha": -24.596976632509524, "vvs": 0.8074061027478847, "vvh": -41.565018194007514, "vhalfs": -47.09088291409242, "zetas": 13.859187188926501},
# "Y428F":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "E430A":{"Rd": 0.026677508089259255, "Rg": 0.018380854986396883, "Rb": 0.06985075972094257, "Ra": 0.3293720730352896, "a0s": 9.749269601282595e-05, "gms": 0.1085334582648832, "hmin": 0.004829424842704833, "mmin": 0.004109889968571915, "qinf": 5.729977253750414, "q10": 1.3373955928938328, "qg": 0.7874130399068441, "qd": 0.46077016577292707, "qa1": 6.9191800915182355, "smax": 7.299250833375195, "sh": 8.6816135149496, "thinf": -40.45470672763298, "thi2": -79.71225133749859, "thi1": -58.80338296950646, "tha": -24.113225705793987, "vvs": 1.276502872733726, "vvh": -59.81257463651943, "vhalfs": -32.1070972484901, "zetas": 14.25086757675879},
# "G822S":{"Rd": 0.01836104620638983, "Rg": 0.014448007629532958, "Rb": 0.05033360067765975, "Ra": 0.1479859791347649, "a0s": 0.00040034597874314434, "gms": 0.10207977056158085, "hmin": 0.008402295569295696, "mmin": 0.016405019233840676, "qinf": 5.678352387217695, "q10": 1.6498665948579145, "qg": 1.1053715538312434, "qd": 0.9949830303082219, "qa1": 5.037747778146663, "smax": 4.898902736929596, "sh": 7.757683033801925, "thinf": -40.235582244107164, "thi2": -76.49640157582847, "thi1": -62.41916713809693, "tha": -26.13996706113397, "vvs": 1.0831195133294775, "vvh": -51.70951151061714, "vhalfs": -56.33022537032784, "zetas": 13.987911544304342},
# "S834N":{"Rd": 0.02740372324846431, "Rg": 0.0169135274590998, "Rb": 0.02680751933602825, "Ra": 0.35580950041266657, "a0s": 0.00038197695079367477, "gms": 0.07113735594264348, "hmin": 0.018733753931814645, "mmin": 0.01610667418460594, "qinf": 5.830193640384993, "q10": 1.8102970708810764, "qg": 0.05926324817867845, "qd": 0.41728059347862256, "qa1": 4.57595887360314, "smax": 8.015676729533139, "sh": 8.22953205814402, "thinf": -45.57290283527013, "thi2": -79.0009726790646, "thi1": -61.19691104947065, "tha": -23.273647655228697, "vvs": 0.8890281355522675, "vvh": -56.69761729173847, "vhalfs": -29.970017085580373, "zetas": 10.497465125795127},
# "R853Q":{"Rd": 0.02494963887651306, "Rg": 0.0159324991098267, "Rb": 0.008346683829142144, "Ra": 0.23318070680306324, "a0s": 0.0002076213904715824, "gms": 0.03282022294859574, "hmin": 0.012349530264114037, "mmin": 0.02356196470610117, "qinf": 5.306520917767803, "q10": 2.953502942333617, "qg": 0.7515010803245216, "qd": 0.9603988507606309, "qa1": 6.966426905480968, "smax": 0.8423790188118474, "sh": 9.437189108999785, "thinf": -48.36397124509376, "thi2": -50.90518610755897, "thi1": -71.82609196043677, "tha": -23.07313984067082, "vvs": 1.1720936860640736, "vvh": -54.1156469133095, "vhalfs": -78.1899013879206, "zetas": 13.210761037389423},
# "G879R":{"Rd": 0.027662592574010117, "Rg": 0.01788174460021371, "Rb": 0.09529679182151982, "Ra": 0.24523653722045663, "a0s": 0.0005053733898912993, "gms": 0.2339469426623767, "hmin": 0.006948467701243528, "mmin": 0.014880347682142747, "qinf": 5.660450430815069, "q10": 2.026646277220725, "qg": 0.4722659039716983, "qd": 0.5490307534124598, "qa1": 5.388016909833489, "smax": 0.3320196281434029, "sh": 8.17193228206933, "thinf": -40.090516939036654, "thi2": -70.8580578256981, "thi1": -60.476452508427116, "tha": -26.067180942835762, "vvs": 0.2944825944002297, "vvh": -51.93662748207426, "vhalfs": -31.21342387239771, "zetas": 14.601976607278747},
# "A880S":{"Rd": 0.024983850656756203, "Rg": 0.01264910343285493, "Rb": 0.0671547619149891, "Ra": 0.29871487032677263, "a0s": 0.00039900460817951565, "gms": 0.03536358304959653, "hmin": 0.011111935737926851, "mmin": 0.005072603039332912, "qinf": 5.97398485711303, "q10": 2.7192866443234327, "qg": 2.7084655294243274, "qd": 0.6110591323106617, "qa1": 6.003191778589493, "smax": 11.253364966342582, "sh": 9.399418144907186, "thinf": -40.12284003491786, "thi2": -69.2828562872844, "thi1": -49.17584807379874, "tha": -22.89913590367137, "vvs": 2.8723323218182406, "vvh": -59.17710332246198, "vhalfs": -69.75795867295813, "zetas": 13.28103501189872},
# "L881P":{"Rd": 0.028890184371937362, "Rg": 0.010322155248900663, "Rb": 0.14133486076744964, "Ra": 0.10641933856735347, "a0s": 0.0005777834956471201, "gms": 0.057150032029150144, "hmin": 0.012813924302415052, "mmin": 0.01839574310191013, "qinf": 5.709079463910518, "q10": 1.730609608655985, "qg": 1.3079401810172744, "qd": 0.8943407979099117, "qa1": 3.9938381277096866, "smax": 14.259140946368237, "sh": 9.643612237858964, "thinf": -39.897989761839376, "thi2": -42.67970859478132, "thi1": -72.98177306054025, "tha": -34.65123292728352, "vvs": 2.0122668094880054, "vvh": -50.53683861456274, "vhalfs": -45.592979068931186, "zetas": 11.308304323589649},
# "G882E":{"Rd": 0.021758632592294044, "Rg": 0.015502540922713847, "Rb": 0.11344401555453035, "Ra": 0.09678550428619982, "a0s": 0.00013855391167775708, "gms": 0.17622511455830672, "hmin": 0.010216859549117531, "mmin": 0.0012194413397115763, "qinf": 5.424617341189145, "q10": 2.0794003904950484, "qg": 0.885145546791212, "qd": 0.43268447783952646, "qa1": 4.741712373703728, "smax": 1.6054775679032622, "sh": 9.166568199052614, "thinf": -39.727631377504615, "thi2": -66.58443677945446, "thi1": -69.46647023278386, "tha": -32.88638496215651, "vvs": 0.0029296810691974984, "vvh": -54.13858358022712, "vhalfs": -18.6265340791738, "zetas": 13.604691053223359},
# "F928S":{"Rd": 0.024140692298820234, "Rg": 0.018861272951955617, "Rb": 0.04164914617675008, "Ra": 0.19800736063347332, "a0s": 0.000427089872336297, "gms": 0.1359361529964182, "hmin": 0.01464828233618956, "mmin": 0.007611448226243782, "qinf": 7.445043593967635, "q10": 1.6737200399133252, "qg": 0.6062753064349936, "qd": 0.7761684485138802, "qa1": 6.997483403830205, "smax": 2.9513785694852643, "sh": 8.739336157880611, "thinf": -40.58120458682901, "thi2": -47.30437710033782, "thi1": -59.35471463719074, "tha": -23.350247192409583, "vvs": 0.5704064679160153, "vvh": -53.52145898262074, "vhalfs": -70.53457138880492, "zetas": 9.497846656629417},
# "R937C":{"Rd": 0.028816266980029526, "Rg": 0.01192486003050821, "Rb": 0.12549730528479655, "Ra": 0.14458070397627634, "a0s": 0.00017034056543662406, "gms": 0.2781311400986554, "hmin": 0.0017001187432443775, "mmin": 0.013558719597195559, "qinf": 5.668636956432187, "q10": 1.637745397620502, "qg": 0.27200438691598383, "qd": 0.5942376304799848, "qa1": 5.3657726810535085, "smax": 5.908953129970223, "sh": 8.65269773864324, "thinf": -39.929377933965874, "thi2": -74.86030908251837, "thi1": -62.05430035482323, "tha": -30.504391644095328, "vvs": 0.4196860084672315, "vvh": -58.79096455390417, "vhalfs": -10.134413585362473, "zetas": 10.90117766712532},
# "M951R":{"Rd": 0.027479510273568465, "Rg": 0.005547885215719703, "Rb": 0.10864315427110352, "Ra": 0.1355323793801491, "a0s": 0.0002184861705761704, "gms": 0.09211228651744208, "hmin": 0.005630151948259466, "mmin": 0.009378065063706694, "qinf": 5.690374935951399, "q10": 1.9203744620653833, "qg": 0.9969468729660423, "qd": 0.6765711010864566, "qa1": 4.3961745404410015, "smax": 7.246684254760238, "sh": 5.228078510632624, "thinf": -40.16926539865904, "thi2": -52.84104983397329, "thi1": -70.54602888632071, "tha": -28.098752669821238, "vvs": 0.4094301885280226, "vvh": -35.065597322726745, "vhalfs": -57.48115968474434, "zetas": 5.441271958822974},
# "M965R":{"Rd": 0.025202089806451302, "Rg": 0.009114248006285694, "Rb": 0.05292560602430512, "Ra": 0.12967112226301886, "a0s": 0.00042850396618851055, "gms": 0.2305128335924907, "hmin": 0.009167035961364511, "mmin": 0.017423603897324426, "qinf": 5.345638482605843, "q10": 1.6955271690726292, "qg": 0.9386851728599686, "qd": 0.8396906383228487, "qa1": 4.095437029305131, "smax": 7.846305428343047, "sh": 7.760395064105013, "thinf": -40.37813637352028, "thi2": -58.179784136646724, "thi1": -68.49158705285943, "tha": -29.79583702046239, "vvs": 1.1036593749057158, "vvh": -56.12037597934727, "vhalfs": -51.52690728095499, "zetas": 9.777630203678076},
########## Start here on 10/16/24
# "F978L":{"Rd": 0.026592803395884438, "Rg": 0.016307394106808624, "Rb": 0.181729148271133, "Ra": 0.14596709141611772, "a0s": 0.0002543352868413954, "gms": 0.2755192790052609, "hmin": 0.01765448218076142, "mmin": 0.00590519152233838, "qinf": 5.942780691804547, "q10": 1.001896514074389, "qg": 1.630261429652496, "qd": 0.39863896248440245, "qa1": 4.241546489215119, "smax": 3.6949736011714953, "sh": 5.716642883725424, "thinf": -39.917905323054136, "thi2": -41.80750449237957, "thi1": -79.80032782128028, "tha": -29.639595629371343, "vvs": 1.8101224857387725, "vvh": -34.82866655996365, "vhalfs": -33.16168624486301, "zetas": 9.332028832572481},
# "E1133D":{"Rd": 0.029868702586735053, "Rg": 0.01942358894271495, "Rb": 0.02810855160437927, "Ra": 0.35015528083689396, "a0s": 0.00026596781209522764, "gms": 0.15285984153663817, "hmin": 0.007377811429769208, "mmin": 0.018281573748719734, "qinf": 4.553741270092768, "q10": 2.6546849248600863, "qg": 0.28982564438167224, "qd": 0.8697162609151862, "qa1": 6.985090994932428, "smax": 9.498133166669868, "sh": 9.85608708243732, "thinf": -41.102783350842834, "thi2": -58.06381924345427, "thi1": -68.80739121463262, "tha": -22.375423663215013, "vvs": 1.024288209662664, "vvh": -47.23729133555429, "vhalfs": -65.092767770147, "zetas": 11.770138170639774},
# "E1211K":{"Rd": 0.020222564351983708, "Rg": 0.017622987843737885, "Rb": 0.15212448608197354, "Ra": 0.15040303973681712, "a0s": 0.00036672641029272633, "gms": 0.11289528696086513, "hmin": 0.015103045204533724, "mmin": 0.0167997980215948, "qinf": 7.174371808457541, "q10": 1.7875185245997034, "qg": 2.5784650513122416, "qd": 0.9497020400765177, "qa1": 5.186786430502393, "smax": 12.614140567983352, "sh": 9.343679203914855, "thinf": -53.2366752777964, "thi2": -36.28962505900306, "thi1": -79.5329804443463, "tha": -35.13761486324888, "vvs": 1.0921826518875117, "vvh": -40.03307374740584, "vhalfs": -23.553872666158224, "zetas": 4.669785868118981},
# "C1275R":{"Rd": 0.025187244539935275, "Rg": 0.019989560539672352, "Rb": 0.14380171874162131, "Ra": 0.22325548912893095, "a0s": 0.00033623483904289065, "gms": 0.012456295347573462, "hmin": 0.007109129419094504, "mmin": 0.0253093017162345, "qinf": 8.547423760267895, "q10": 1.47192660216142, "qg": 0.4272554563294339, "qd": 0.7886190219718726, "qa1": 5.500762755144136, "smax": 6.289118328480329, "sh": 9.360315773564531, "thinf": -55.14570064224404, "thi2": -77.18784839713925, "thi1": -62.991618321938546, "tha": -33.76756904130741, "vvs": 0.4768777514988356, "vvh": -47.63945663512682, "vhalfs": -55.86222917222494, "zetas": 3.958109086431536},
# "R1315G":{"Rd": 0.023720986789098543, "Rg": 0.010576668025571275, "Rb": 0.1926391653877214, "Ra": 0.09254181767370062, "a0s": 0.0003786690751947601, "gms": 0.10820140358095624, "hmin": 0.019052233357443094, "mmin": 0.018072543940817976, "qinf": 5.5804674833113594, "q10": 1.3635050389532717, "qg": 0.6703249273515767, "qd": 0.908327268134581, "qa1": 4.817319672402452, "smax": 10.075377542559055, "sh": 7.978965826341755, "thinf": -40.1341112290362, "thi2": -41.60505443784972, "thi1": -73.79031347152991, "tha": -33.96860334176461, "vvs": 2.678968344904754, "vvh": -30.341729621312975, "vhalfs": -28.95620105333142, "zetas": 12.236400230995216},
# "I1334T":{"Rd": 0.016267393469871445, "Rg": 0.011209368814702638, "Rb": 0.05904438976764493, "Ra": 0.12813659666001836, "a0s": 0.00019619934118372562, "gms": 0.0609671939194463, "hmin": 0.002090245102868394, "mmin": 0.01350069381751443, "qinf": 5.924188095122376, "q10": 2.509860561486748, "qg": 0.2933144482511959, "qd": 0.5243910525085855, "qa1": 4.403815323865329, "smax": 12.85264721018965, "sh": 9.793035071827656, "thinf": -43.9454819898338, "thi2": -77.25766470725179, "thi1": -70.95561248954935, "tha": -25.044656341118642, "vvs": 0.1618799274890229, "vvh": -38.092707855772126, "vhalfs": -37.93705312345776, "zetas": 11.325779362425608},
# "F1375V":{"Rd": 0.022839156737266504, "Rg": 0.008040016542198106, "Rb": 0.013108173302600183, "Ra": 0.13550388496038548, "a0s": 0.00039429533608287726, "gms": 0.06732923317274854, "hmin": 0.009936633912466833, "mmin": 0.009237312978154643, "qinf": 6.231161213878303, "q10": 2.717635921185319, "qg": 0.17639728910831654, "qd": 0.5829049830050151, "qa1": 6.9128606870917295, "smax": 3.627167015180552, "sh": 6.185631234506812, "thinf": -47.941049650063356, "thi2": -67.21723742303824, "thi1": -72.15853618704223, "tha": -23.81094678566632, "vvs": 2.931443494987703, "vvh": -38.388883934132195, "vhalfs": -11.95690788227412, "zetas": 8.320581786463814},
# "K1422E":{"Rd": 0.02374685728279963, "Rg": 0.00982342422097703, "Rb": 0.05346520988436413, "Ra": 0.16595503600930908, "a0s": 0.0002577555996627711, "gms": 0.24922442650522145, "hmin": 0.017413391439645175, "mmin": 0.021328853040181003, "qinf": 5.827158267826417, "q10": 1.278305029075351, "qg": 1.131947544817129, "qd": 0.1975265348251266, "qa1": 4.319452818639588, "smax": 9.89328251666597, "sh": 9.979410062737685, "thinf": -48.94533574880158, "thi2": -10.276057284746937, "thi1": -73.16382193009244, "tha": -31.160551939841778, "vvs": 1.175038677023626, "vvh": -36.38638788361633, "vhalfs": -25.70553174405286, "zetas": 14.762352817196271},
# "I1473K":{"Rd": 0.01956568387476942, "Rg": 0.019989408397139165, "Rb": 0.11993932182468042, "Ra": 0.11658990953701547, "a0s": 8.887588889717481e-05, "gms": 0.18285395292936132, "hmin": 0.0032197234064074605, "mmin": 0.00634432435004026, "qinf": 5.682181419084113, "q10": 1.5908036304858135, "qg": 1.2118621323583587, "qd": 0.8327544228463378, "qa1": 5.4837124285964, "smax": 13.085196921538316, "sh": 8.710491239052939, "thinf": -40.03803901037192, "thi2": -27.074392423146058, "thi1": -76.35118755602886, "tha": -31.748133964745424, "vvs": 2.830165430590071, "vvh": -47.768536303708295, "vhalfs": -52.65419619824172, "zetas": 9.040615152237192},
# "M1490V":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "F1590S":{"Rd": 0.029474458284900158, "Rg": 0.018116627714792978, "Rb": 0.00497101478163562, "Ra": 0.13492550499027128, "a0s": 0.00040585258299479047, "gms": 0.0832066051354939, "hmin": 0.01207196871276265, "mmin": 0.022195521706389547, "qinf": 5.931212792509285, "q10": 1.9255950587529629, "qg": 1.4850120035229915, "qd": 0.038433967804552896, "qa1": 2.0802840402634306, "smax": 4.755896150550251, "sh": 6.736842631745331, "thinf": -52.83229892841495, "thi2": -41.439894713672444, "thi1": -78.81526990155876, "tha": -31.309360194774346, "vvs": 0.012533211140852651, "vvh": -52.83337787036113, "vhalfs": -61.28331129857994, "zetas": 8.708580313510867},
# "R1626Q":{"Rd": 0.015705999497515298, "Rg": 0.012837890314805582, "Rb": 0.0924389909031625, "Ra": 0.18782133198831374, "a0s": 0.0005528477686079306, "gms": 0.00015655970014944592, "hmin": 0.01089195196549212, "mmin": 0.013354397329189754, "qinf": 5.807768656486893, "q10": 1.9346428296408633, "qg": 0.14165380799247307, "qd": 0.9574822721096936, "qa1": 6.7318605780699645, "smax": 8.807898092477327, "sh": 9.55816764866535, "thinf": -35.66045499460463, "thi2": -53.19560126791692, "thi1": -52.71580690138354, "tha": -25.946993764478627, "vvs": 1.282130687276493, "vvh": -58.946114484334885, "vhalfs": -50.27847191202843, "zetas": 14.92653651262356},
# "R1629H":{"Rd": 0.01628704519464043, "Rg": 0.009161634659666264, "Rb": 0.08888320106599679, "Ra": 0.11238725788888865, "a0s": 0.00024571481293414026, "gms": 0.19092554167159517, "hmin": 0.0002059325279567439, "mmin": 0.012800049320222329, "qinf": 6.471473690649019, "q10": 1.5509059353360817, "qg": 0.018007937329949764, "qd": 0.8419809765770232, "qa1": 6.371842333256621, "smax": 6.1681974375862465, "sh": 8.94172390294559, "thinf": -40.11486697100523, "thi2": -32.61284873760393, "thi1": -56.03289839185245, "tha": -28.712363096370847, "vvs": 0.39516637495347673, "vvh": -55.91622279226972, "vhalfs": -13.08703801829925, "zetas": 14.610945549535526},
# "L1650P":{"Rd": 0.025084892369208304, "Rg": 0.01040033188918278, "Rb": 0.1471133904353179, "Ra": 0.12627331817191256, "a0s": 0.000507369110432331, "gms": 0.2752161539831546, "hmin": 0.01463145066323985, "mmin": 0.021497713786847682, "qinf": 5.706049006568357, "q10": 2.6928577368826034, "qg": 1.7989027149027743, "qd": 0.6004453527999988, "qa1": 4.80804431497344, "smax": 8.737682742909099, "sh": 5.481536795376977, "thinf": -40.23972972519164, "thi2": -37.693857209628796, "thi1": -78.25626581166316, "tha": -29.65091659145075, "vvs": 1.4097484269299723, "vvh": -58.17664278807413, "vhalfs": -41.67829887152851, "zetas": 2.646790790568417},
# "N1662D":{"Rd": 0.024834613531559222, "Rg": 0.00722975964292745, "Rb": 0.1550302575526089, "Ra": 0.13443309172097404, "a0s": 0.00035257955418299404, "gms": 0.2715509977891627, "hmin": 0.0069487527693521895, "mmin": 0.029020307079725315, "qinf": 5.77155197958442, "q10": 2.3007900442618365, "qg": 1.744064258101805, "qd": 0.07448775023986948, "qa1": 4.981107977341132, "smax": 11.181454257784935, "sh": 9.88925715062046, "thinf": -39.86440480009722, "thi2": -45.72023275259561, "thi1": -75.09290125911001, "tha": -33.550886388857535, "vvs": 0.3383457586372628, "vvh": -48.43204158052824, "vhalfs": -13.495638181255485, "zetas": 3.475925659093414},
# "L1666F":{"Rd": 0.02932893334441289, "Rg": 0.009402252150539477, "Rb": 0.06660657703084336, "Ra": 0.296390819821439, "a0s": 0.0005369251073385448, "gms": 0.035911354564352266, "hmin": 0.00022180136750819362, "mmin": 0.02567389010294119, "qinf": 7.646851922607546, "q10": 1.8380151187914084, "qg": 0.4526817724606314, "qd": 0.4252924445235433, "qa1": 4.447282359458878, "smax": 10.965953372258415, "sh": 5.931492583392366, "thinf": -60.36491795447346, "thi2": -74.16911097017109, "thi1": -64.40453860999703, "tha": -27.365316047221967, "vvs": 0.8432682808685397, "vvh": -55.43607757648059, "vhalfs": -26.516117663338846, "zetas": 5.661903306008736},
# "S1758R":{"Rd": 0.02620442853427327, "Rg": 0.01608415955554826, "Rb": 0.11560690116516467, "Ra": 0.14677307732455835, "a0s": 0.00035166423331131657, "gms": 0.056608612305900224, "hmin": 0.011907018878373562, "mmin": 0.017003471889375767, "qinf": 5.697520515428508, "q10": 2.551519909392709, "qg": 1.3997825544319742, "qd": 0.904101776700958, "qa1": 4.4590070859599145, "smax": 1.54168740980701, "sh": 7.232663589443712, "thinf": -39.89183168671908, "thi2": -61.4153690682283, "thi1": -75.45178365666219, "tha": -30.285274894639297, "vvs": 0.9789909089245109, "vvh": -48.81283365716541, "vhalfs": -47.033527719066285, "zetas": 14.756704515498393},
# "Y1771H":{"Rd": 0.026322068859006283, "Rg": 0.010120521996233088, "Rb": 0.11957348403726224, "Ra": 0.12655120459968608, "a0s": 0.0003811172958202199, "gms": 0.13425722474301358, "hmin": 0.017551103321137206, "mmin": 0.02276486619600432, "qinf": 5.596463977958527, "q10": 2.651255148169718, "qg": 0.9991718248904763, "qd": 0.058559121453408414, "qa1": 3.4429150752596547, "smax": 6.751904060606486, "sh": 9.236605021030268, "thinf": -39.73996859315003, "thi2": -79.97873869412409, "thi1": -77.23196495890313, "tha": -32.963744309547714, "vvs": 0.912942048317187, "vvh": -55.37710490850162, "vhalfs": -10.119063371666337, "zetas": 12.131605344666884},
# "S1780I":{"Rd": 0.02976927710474845, "Rg": 0.019606242619056087, "Rb": 0.16380743043761506, "Ra": 0.3405909301293956, "a0s": 0.0005679521872484947, "gms": 0.2136944784205961, "hmin": 0.010396096866704375, "mmin": 0.014207390597127341, "qinf": 5.835172363748512, "q10": 1.9988869994486225, "qg": 0.0018982164031558085, "qd": 0.9802903514834602, "qa1": 6.4300431535512885, "smax": 3.0181516380867484, "sh": 8.31480822483682, "thinf": -34.877188755877555, "thi2": -72.24205159231637, "thi1": -53.8107002609595, "tha": -24.782318209834916, "vvs": 0.4434530943419912, "vvh": -42.213877997934404, "vhalfs": -33.00656867989213, "zetas": 10.008352211439751},
# "R19K":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "G211D":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "E430A":{"Rd": 0.026677508089259255, "Rg": 0.018380854986396883, "Rb": 0.06985075972094257, "Ra": 0.3293720730352896, "a0s": 9.749269601282595e-05, "gms": 0.1085334582648832, "hmin": 0.004829424842704833, "mmin": 0.004109889968571915, "qinf": 5.729977253750414, "q10": 1.3373955928938328, "qg": 0.7874130399068441, "qd": 0.46077016577292707, "qa1": 6.9191800915182355, "smax": 7.299250833375195, "sh": 8.6816135149496, "thinf": -40.45470672763298, "thi2": -79.71225133749859, "thi1": -58.80338296950646, "tha": -24.113225705793987, "vvs": 1.276502872733726, "vvh": -59.81257463651943, "vhalfs": -32.1070972484901, "zetas": 14.25086757675879},
# "R571H":{"Rd": 0.02812173529302272, "Rg": 0.018327531956099142, "Rb": 0.19992458371090535, "Ra": 0.3170239172425175, "a0s": 4.0617263495419395e-06, "gms": 0.19507851193630715, "hmin": 0.01589140919547058, "mmin": 0.020278784194682858, "qinf": 7.328520851598185, "q10": 2.402297241372281, "qg": 0.5638438912632477, "qd": 0.510209727208502, "qa1": 6.953658616823861, "smax": 3.741262885256002, "sh": 8.065303311535853, "thinf": -39.986992713663895, "thi2": -40.68328785996022, "thi1": -52.786306896871764, "tha": -25.637427574476508, "vvs": 1.8247582190059108, "vvh": -59.29150837394824, "vhalfs": -19.263687458904858, "zetas": 9.598689662194012},
"R853Q":{"Rd": 0.02494963887651306, "Rg": 0.0159324991098267, "Rb": 0.008346683829142144, "Ra": 0.23318070680306324, "a0s": 0.0002076213904715824, "gms": 0.03282022294859574, "hmin": 0.012349530264114037, "mmin": 0.02356196470610117, "qinf": 5.306520917767803, "q10": 2.953502942333617, "qg": 0.7515010803245216, "qd": 0.9603988507606309, "qa1": 6.966426905480968, "smax": 0.8423790188118474, "sh": 9.437189108999785, "thinf": -48.36397124509376, "thi2": -50.90518610755897, "thi1": -71.82609196043677, "tha": -23.07313984067082, "vvs": 1.1720936860640736, "vvh": -54.1156469133095, "vhalfs": -78.1899013879206, "zetas": 13.210761037389423},}
# "G879R":{"Rd": 0.027662592574010117, "Rg": 0.01788174460021371, "Rb": 0.09529679182151982, "Ra": 0.24523653722045663, "a0s": 0.0005053733898912993, "gms": 0.2339469426623767, "hmin": 0.006948467701243528, "mmin": 0.014880347682142747, "qinf": 5.660450430815069, "q10": 2.026646277220725, "qg": 0.4722659039716983, "qd": 0.5490307534124598, "qa1": 5.388016909833489, "smax": 0.3320196281434029, "sh": 8.17193228206933, "thinf": -40.090516939036654, "thi2": -70.8580578256981, "thi1": -60.476452508427116, "tha": -26.067180942835762, "vvs": 0.2944825944002297, "vvh": -51.93662748207426, "vhalfs": -31.21342387239771, "zetas": 14.601976607278747},
# "G882E":{"Rd": 0.021758632592294044, "Rg": 0.015502540922713847, "Rb": 0.11344401555453035, "Ra": 0.09678550428619982, "a0s": 0.00013855391167775708, "gms": 0.17622511455830672, "hmin": 0.010216859549117531, "mmin": 0.0012194413397115763, "qinf": 5.424617341189145, "q10": 2.0794003904950484, "qg": 0.885145546791212, "qd": 0.43268447783952646, "qa1": 4.741712373703728, "smax": 1.6054775679032622, "sh": 9.166568199052614, "thinf": -39.727631377504615, "thi2": -66.58443677945446, "thi1": -69.46647023278386, "tha": -32.88638496215651, "vvs": 0.0029296810691974984, "vvh": -54.13858358022712, "vhalfs": -18.6265340791738, "zetas": 13.604691053223359},
# "K908R":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "R937C":{"Rd": 0.028816266980029526, "Rg": 0.01192486003050821, "Rb": 0.12549730528479655, "Ra": 0.14458070397627634, "a0s": 0.00017034056543662406, "gms": 0.2781311400986554, "hmin": 0.0017001187432443775, "mmin": 0.013558719597195559, "qinf": 5.668636956432187, "q10": 1.637745397620502, "qg": 0.27200438691598383, "qd": 0.5942376304799848, "qa1": 5.3657726810535085, "smax": 5.908953129970223, "sh": 8.65269773864324, "thinf": -39.929377933965874, "thi2": -74.86030908251837, "thi1": -62.05430035482323, "tha": -30.504391644095328, "vvs": 0.4196860084672315, "vvh": -58.79096455390417, "vhalfs": -10.134413585362473, "zetas": 10.90117766712532},
# "F978L":{"Rd": 0.026592803395884438, "Rg": 0.016307394106808624, "Rb": 0.181729148271133, "Ra": 0.14596709141611772, "a0s": 0.0002543352868413954, "gms": 0.2755192790052609, "hmin": 0.01765448218076142, "mmin": 0.00590519152233838, "qinf": 5.942780691804547, "q10": 1.001896514074389, "qg": 1.630261429652496, "qd": 0.39863896248440245, "qa1": 4.241546489215119, "smax": 3.6949736011714953, "sh": 5.716642883725424, "thinf": -39.917905323054136, "thi2": -41.80750449237957, "thi1": -79.80032782128028, "tha": -29.639595629371343, "vvs": 1.8101224857387725, "vvh": -34.82866655996365, "vhalfs": -33.16168624486301, "zetas": 9.332028832572481},
# "D997G":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "E999K":{"Rd": 0.026143636968066552, "Rg": 0.01668223028930355, "Rb": 0.014291884348195151, "Ra": 0.3173306743768715, "a0s": 0.0005030781620195419, "gms": 0.2257551972957173, "hmin": 0.01486999595016371, "mmin": 0.01069596553673631, "qinf": 4.543449675893968, "q10": 2.905858138508142, "qg": 1.070567987818106, "qd": 0.8859991427475545, "qa1": 2.7332610992423385, "smax": 4.562540093135402, "sh": 8.697260358969865, "thinf": -40.098974160495985, "thi2": -79.86939611595125, "thi1": -59.571867025996255, "tha": -25.969320595959655, "vvs": 0.05603301531867544, "vvh": -47.92236852687354, "vhalfs": -24.29418118596604, "zetas": 11.472449828098517},
# "D1050V":{"Rd": 0.016599038716142038, "Rg": 0.019631779169964003, "Rb": 0.16471623804327126, "Ra": 0.3675437277858877, "a0s": 0.0003724630223432994, "gms": 0.1091110068221609, "hmin": 0.0035814316171162252, "mmin": 0.006593426351276054, "qinf": 6.016363782044474, "q10": 2.765998024230771, "qg": 0.717979924147514, "qd": 0.7883118524902605, "qa1": 6.31838792331545, "smax": 14.784100182344993, "sh": 8.477896449297107, "thinf": -40.23206150794526, "thi2": -42.359054964315185, "thi1": -52.76472778299403, "tha": -22.741945749318504, "vvs": 2.4677238782116384, "vvh": -55.365921069231, "vhalfs": -47.52438385151341, "zetas": 8.751412442426371},
# "E1153K":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "K1260E":{"Rd": 0.025712394696815438, "Rg": 0.01854277725353276, "Rb": 0.09013136340161398, "Ra": 0.3380714915775742, "a0s": 0.0003404044629881207, "gms": 0.12592058965254987, "hmin": 0.008013391774131736, "mmin": 0.008226790739513802, "qinf": 5.760329120353593, "q10": 2.289601426305275, "qg": 0.6693522946835427, "qd": 0.8058343822410788, "qa1": 5.835550042292994, "smax": 5.9733245694423545, "sh": 8.886047186457889, "thinf": -40.114984963535186, "thi2": -77.41692349310195, "thi1": -60.488477521934875, "tha": -24.155451306086988, "vvs": 0.7672523706054653, "vvh": -53.184249317587984, "vhalfs": -33.73363659219147, "zetas": 13.419130866269455},
# "K1260Q":{"Rd": 0.028882150766696896, "Rg": 0.00846023821040383, "Rb": 0.12133284176150029, "Ra": 0.27573536514828995, "a0s": 0.00011326815802696527, "gms": 0.10385971415679313, "hmin": 0.009188631515757053, "mmin": 0.016432026457459215, "qinf": 5.865347721371616, "q10": 2.452124597953734, "qg": 0.04839430939956946, "qd": 0.7176561286836113, "qa1": 5.057195257933746, "smax": 4.501187939372706, "sh": 6.950814145426628, "thinf": -45.081086587972315, "thi2": -67.97367065363201, "thi1": -58.91465521201193, "tha": -30.30791453176898, "vvs": 1.652673451366388, "vvh": -54.58910110982504, "vhalfs": -13.51220190058644, "zetas": 14.976326587058256},
# "R1319L":{"Rd": 0.015740980323239596, "Rg": 0.01905443248305248, "Rb": 0.0920662460289846, "Ra": 0.09349221300929822, "a0s": 0.00013315155719062003, "gms": 0.11065619825756581, "hmin": 0.0019754977110518455, "mmin": 0.016217975122457467, "qinf": 7.060832396520147, "q10": 1.2222690737088593, "qg": 0.012973436035845692, "qd": 0.8617515444211121, "qa1": 3.6827608243067305, "smax": 14.353392475676143, "sh": 9.845773434807084, "thinf": -46.68797148877713, "thi2": -70.9800435262756, "thi1": -78.96640195774417, "tha": -33.29009493809465, "vvs": 1.3449334832905957, "vvh": -42.240889613425345, "vhalfs": -23.06675631307664, "zetas": 9.62187285543805},
# "G1522A":{"Rd": 0.015740980323239596, "Rg": 0.01905443248305248, "Rb": 0.0920662460289846, "Ra": 0.09349221300929822, "a0s": 0.00013315155719062003, "gms": 0.11065619825756581, "hmin": 0.0019754977110518455, "mmin": 0.016217975122457467, "qinf": 7.060832396520147, "q10": 1.2222690737088593, "qg": 0.012973436035845692, "qd": 0.8617515444211121, "qa1": 3.6827608243067305, "smax": 14.353392475676143, "sh": 9.845773434807084, "thinf": -46.68797148877713, "thi2": -70.9800435262756, "thi1": -78.96640195774417, "tha": -33.29009493809465, "vvs": 1.3449334832905957, "vvh": -42.240889613425345, "vhalfs": -23.06675631307664, "zetas": 9.62187285543805},
# "S1758R":{"Rd": 0.02620442853427327, "Rg": 0.01608415955554826, "Rb": 0.11560690116516467, "Ra": 0.14677307732455835, "a0s": 0.00035166423331131657, "gms": 0.056608612305900224, "hmin": 0.011907018878373562, "mmin": 0.017003471889375767, "qinf": 5.697520515428508, "q10": 2.551519909392709, "qg": 1.3997825544319742, "qd": 0.904101776700958, "qa1": 4.4590070859599145, "smax": 1.54168740980701, "sh": 7.232663589443712, "thinf": -39.89183168671908, "thi2": -61.4153690682283, "thi1": -75.45178365666219, "tha": -30.285274894639297, "vvs": 0.9789909089245109, "vvh": -48.81283365716541, "vhalfs": -47.033527719066285, "zetas": 14.756704515498393},
# "S1780I":{"Rd": 0.02976927710474845, "Rg": 0.019606242619056087, "Rb": 0.16380743043761506, "Ra": 0.3405909301293956, "a0s": 0.0005679521872484947, "gms": 0.2136944784205961, "hmin": 0.010396096866704375, "mmin": 0.014207390597127341, "qinf": 5.835172363748512, "q10": 1.9988869994486225, "qg": 0.0018982164031558085, "qd": 0.9802903514834602, "qa1": 6.4300431535512885, "smax": 3.0181516380867484, "sh": 8.31480822483682, "thinf": -34.877188755877555, "thi2": -72.24205159231637, "thi1": -53.8107002609595, "tha": -24.782318209834916, "vvs": 0.4434530943419912, "vvh": -42.213877997934404, "vhalfs": -33.00656867989213, "zetas": 10.008352211439751},
# "M1879T":{"Rd": 0.01676040133331965, "Rg": 0.01121017107369229, "Rb": 0.1493622626737192, "Ra": 0.18265163899798106, "a0s": 0.00010818731042354861, "gms": 0.13520011936369342, "hmin": 0.004635077144133656, "mmin": 0.0017564266050167565, "qinf": 5.772399963700182, "q10": 1.6723355764042798, "qg": 0.3630225008731637, "qd": 0.8014765172400742, "qa1": 6.875458863030893, "smax": 0.690325516414353, "sh": 8.459346321284928, "thinf": -31.910564843990848, "thi2": -43.83075910548185, "thi1": -54.22438072838019, "tha": -27.36299944069825, "vvs": 2.8383613947147106, "vvh": -41.03217099033221, "vhalfs": -23.610064675106642, "zetas": 14.16327046922111},
# "E1880K":{"Rd": 0.017467500546156145, "Rg": 0.005503665444144683, "Rb": 0.06566618211290154, "Ra": 0.20008524199016844, "a0s": 0.0004396099039741604, "gms": 0.29026593520615673, "hmin": 0.007730417588958621, "mmin": 0.016697163897975653, "qinf": 6.238565654290966, "q10": 1.5137704312387084, "qg": 1.5002261538821706, "qd": 0.9913247889927457, "qa1": 6.400117948307667, "smax": 6.308516951913794, "sh": 8.286753453898, "thinf": -40.09368889651956, "thi2": -78.485297571267, "thi1": -50.28037555906838, "tha": -22.969165630295564, "vvs": 0.9550286834072813, "vvh": -46.00645675020381, "vhalfs": -10.840844726160613, "zetas": 13.057461463640774},
# "R1882L":{"Rd": 0.02086744321934721, "Rg": 0.01868108728899148, "Rb": 0.05102311983390648, "Ra": 0.1752687660222031, "a0s": 0.00020465724452855083, "gms": 0.024085461639442998, "hmin": 0.006671427860070729, "mmin": 0.022629417284483675, "qinf": 4.846139590054489, "q10": 2.628984908174992, "qg": 1.6658530868833896, "qd": 0.514737038330895, "qa1": 6.207457287853816, "smax": 2.590292883820121, "sh": 7.6208050150694575, "thinf": -35.149818334024374, "thi2": -74.9673355770313, "thi1": -45.66623155477066, "tha": -18.738448602960307, "vvs": 0.6258024585874049, "vvh": -56.741241364863974, "vhalfs": -52.41828462926225, "zetas": 14.197387528653945},
# "R1882Q":{"Rd": 0.02093349028084322, "Rg": 0.0007472860156779264, "Rb": 0.07927214191553893, "Ra": 0.2475582366027324, "a0s": 1.5230979549604022e-05, "gms": 0.048841308410614674, "hmin": 0.00602984081830873, "mmin": 0.02820171095754885, "qinf": 5.616184882677683, "q10": 2.6472525868201036, "qg": 0.9694186531991292, "qd": 0.6756849366292822, "qa1": 6.0475451034309415, "smax": 14.046910536232756, "sh": 8.220352401570626, "thinf": -35.09461557545267, "thi2": -79.90360710970097, "thi1": -53.502277322579545, "tha": -23.3300440365342, "vvs": 0.7256665808935034, "vvh": -40.39913709527713, "vhalfs": -19.029441887333466, "zetas": 13.328784044528954}}

for config_name, config in config_dict3.items():
  path = f'2-R853Q_tuning_102524'
  
  ##WT model
  # simwt = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
  #                                 ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
  #                             na12name = 'na12annaTFHH',mut_name = 'na12annaTFHH',na12mechs = ['na12','na12mut'],
  #                             na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
  #                             plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  # wt_Vm1,_,wt_t1,_ = simwt.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
  # wt_fi=simwt.plot_fi_curve_2line(wt_data=None,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'WT', epochlabel='500ms')
  # simwt.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx='WT')
  # NeuronModel.chandensities(name = f'{root_path_out}/{path}/densities_WT') ##TF uncomment to run function and plot channel densities in axon[0]
  
  # features_df1 = ef.get_features(sim=simwt, prefix='WT', mut_name = 'na12annaTFHH2')
  

# variantname = sys.argv[1]


# modify_dict_file(filename12mut,adilvariants[variantname])


for mutname,dict in adilvariants.items():
  print(f"mutname is {mutname}")
  print(f"it's corresponding dictionary is {dict}")
  modify_dict_file(filename12mut,dict)
  # modify_dict_file(filename16,dict)

 # ##Adil HH muts
  # sim_mut = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
  #                                 ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
  #                             na12name = 'na12annaTFHH',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
  #                             na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
  #                             plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  # # het_Vm1,_,het_t1,_ = sim_het.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #sim_config for changing regions
  # het_fi=sim_mut.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'{mutname}', epochlabel='500ms')
  # sim_mut.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=config,vs_amp=[0.5], fnpre=f'{mutname}')#sim_config for changing regions
  # sim_mut.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx=f'{mutname}-')
  
  ##WT model
  simwt = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                              na12name = 'na12annaTFHH',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
  
  
  # ##het model
  # sim_het = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
  #                             ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
  #                             na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
  #                             na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
  #                             plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  # # het_Vm1,_,het_t1,_ = sim_het.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #sim_config for changing regions
  # # het_fi=sim_het.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'WTHET')
  # sim_het.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=config,vs_amp=[0.5], fnpre=f'WTvsHET-{mutname}')#sim_config for changing regions
  # # sim_het.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx='HET')
  # NeuronModel.chandensities(name = f'{root_path_out}/{path}/densities_Het') ##TF uncomment to run function and plot channel densities in axon[0]
  # features_df2 = ef.get_features(sim=sim_het, prefix='HET', mut_name = 'na12annaTFHH2')
  


  # ##KO model
  # sim_ko = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
  #                             ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
  #                             na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2mut',na12mechs = ['na12','na12mut'],
  #                             na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
  #                             plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  # # sim_ko.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=het_fi,start=-0.4,end=1,nruns=140, fn=f'WTHETKO')
  # sim_ko.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=config,vs_amp=[0.5], fnpre=f'{mutname}_wthetkoDVDT')#vs_amp=[0.5]
  # sim_ko.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx='KO')
  # NeuronModel.chandensities(name = f'{root_path_out}/{path}/densities_KO') ##TF uncomment to run function and plot channel densities in axon[0]
  # features_df3 = ef.get_features(sim=sim_ko, prefix='KO', mut_name = 'na12annaTFHH2')
  
  for fac in [0.001,0.01,0.1,2,4,10,100]:
    
    
    sim_ais12 = tf.Na12Model_TF(ais_nav12_fac=12*1.2*fac,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_ais12.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'ais12-{fac}')
    
    
    sim_ais16 = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6*fac,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_ais16.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'ais16-{fac}')
    
    
    sim_n12 = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1*fac,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_n12.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'n12-{fac}')
    

    sim_n16 = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3*fac, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_n16.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'n16-{fac}')
    

    sim_somaK = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01*fac, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_somaK.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'somaK-{fac}')
    

    sim_KP = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15*fac, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_KP.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'KP-{fac}')
    

    sim_KT = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5*fac,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_KT.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'KT-{fac}')
    

    sim_aisca = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1*fac,ais_Kca = 0.5,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_aisca.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'aisca-{fac}')
    

    sim_ais_Kca = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5*fac,soma_na16=1*0.8,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_ais_Kca.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'ais_Kca-{fac}')
    

    sim_soma_na16 = tf.Na12Model_TF(ais_nav12_fac=12*1.2,ais_nav16_fac=12*0.6,nav12=1,nav16=1.3, somaK=1*2.2*0.01, KP=25*0.15, KT=5,
                                  ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1*0.8*fac,soma_na12=3.2*0.8,node_na = 1,
                                na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/', update=True)
    sim_soma_na16.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'soma_na16-{fac}')
  


  '''
  ##SomaK
  ##WT model
  simwt_somaK = tf.Na12Model_TF(ais_nav12_fac=12,ais_nav16_fac=12,nav12=1,nav16=1.3, somaK=1*2.2*factor, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1,soma_na12=3.2,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt_somaK.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##het model
  sim_het_somaK = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2*factor, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm1,_,het_t1,_ = sim_het_somaK.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##KO model
  sim_ko_somaK = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2*factor, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  sim_ko_somaK.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WTvHETvKO_somaK-{factor}')
  

  ##KP
  ##WT model
  simwt_KP = tf.Na12Model_TF(ais_nav12_fac=12,ais_nav16_fac=12,nav12=1,nav16=1.3, somaK=1*2.2, KP=25*0.15*factor, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1,soma_na12=3.2,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt_KP.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##het model
  sim_het_KP = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2, KP=25*0.15*factor, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm1,_,het_t1,_ = sim_het_KP.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##KO model
  sim_ko_KP = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2, KP=25*0.15*factor, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  sim_ko_KP.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WTvHETvKO_KP-{factor}')
  

  ##KT
  ##WT model
  simwt_KT = tf.Na12Model_TF(ais_nav12_fac=12,ais_nav16_fac=12,nav12=1,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5*factor,
                            ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=1,soma_na12=3.2,node_na = 1,
                            na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                            na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                            plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt_KT.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##het model
  sim_het_KT = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5*factor,
                            ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
                            na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                            na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                            plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm1,_,het_t1,_ = sim_het_KT.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##KO model
  sim_ko_KT = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5*factor,
                            ais_ca = 100*8.6*0.1,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
                            na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                            na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                            plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  sim_ko_KT.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WTvHETvKO_KT-{factor}')


  ##ais_ca
  ##WT model
  simwt_AISCA = tf.Na12Model_TF(ais_nav12_fac=12,ais_nav16_fac=12,nav12=1,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1*factor,ais_Kca = 0.5,soma_na16=1,soma_na12=3.2,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt_AISCA.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##het model
  sim_het_AISCA = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1*factor,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm1,_,het_t1,_ = sim_het_AISCA.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##KO model
  sim_ko_AISCA = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1*factor,ais_Kca = 0.5,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  sim_ko_AISCA.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WTvHETvKO_AISCA-{factor}')
 
 
  
  ##ais_Kca
  ##WT model
  simwt_aisKca = tf.Na12Model_TF(ais_nav12_fac=12,ais_nav16_fac=12,nav12=1,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5*factor,soma_na16=1,soma_na12=3.2,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  wt_Vm1,_,wt_t1,_ = simwt_aisKca.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##het model
  sim_het_aisKca = tf.Na12Model_TF(ais_nav12_fac=6,ais_nav16_fac=12,nav12=0.5,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5*factor,soma_na16=0.8+0.2,soma_na12=3.6-0.4,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm1,_,het_t1,_ = sim_het_aisKca.get_stim_raw_data(stim_amp =0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = sim_config_soma)
  ##KO model
  sim_ko_aisKca = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=12,nav12=0,nav16=1.3, somaK=1*2.2, KP=25*0.15, KT=5,
                              ais_ca = 100*8.6*0.1,ais_Kca = 0.5*factor,soma_na16=0.8+0.2,soma_na12=0,node_na = 1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  sim_ko_aisKca.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,het_Vm=het_Vm1,het_t=het_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WTvHETvKO_aisKca-{factor}')

'''















