from NeuronModelClass import NeuronModel
from NrnHelper import *
import NrnHelper as nh
import matplotlib.pyplot as plt
import sys
from pathlib import Path
import numpy as np
from Na12HMMModel_TF import *
import Na12HMMModel_TF as tf
import os
import efel_feature_extractor as ef
from currentscape.currentscape import plot_currentscape
import logging
import pandas as pd
# import Document as doc
# import Tim_ng_functions as nf


# Define morphology files
morphology_files = {
    0: "dend-C060114A2_axon-C060114A5.asc",
    1: "1-04a_pyramidal4aACC.asc",
    2: "2-py-260608.asc",
    3: "3-07a_pyramidal13aACC.asc",
    4: "4-04b_pyramidal6aFI.asc",
    5: "5-03a_pyramidal9aFI.asc",
    6: "6-03b_pyramidal2aACC.asc",
    7: "7-02b_pyramidal1aACC.asc",
}

# Set the default morphology index
# morphology_index = 0

# Function to set the morphology index from Python
def set_morphology(index):
    global morphology_index
    if index in morphology_files:
        morphology_index = index
        print(f"Morphology set to index: {index}, file: {morphology_files[index]}")
    else:
        print(f"ERROR: Invalid morphology index: {index}.  Using default.")
        morphology_index = 0






sim_config_soma = {
                'section' : 'soma',
                'segment' : 0.5,
                'section_num': 0,
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'],
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                'ionic_concentrations' :["cai", "ki", "nai"]
                }

#################################################################################
#1
# sim_config_soma = {
                # 'section' : 'soma',
                # 'segment' : 0.5,
                # 'section_num': 0,
                # #'currents' : ['ina','ica','ik'],
                # 'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                # #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                # #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # #'currents'  : ['ihcn_Ih','ik_SKv3_1','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # 'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                # 'ionic_concentrations' :["cai", "ki", "nai"]
                # #'ionic_concentrations' :["ki", "nai"]
                # }
# 2
sim_config_ais = {
                'section' : 'axon',
                'segment' : 0.1,
                'section_num': 0,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                #'currents'  : ['ihcn_Ih','ik_SKv3_1','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
# 3
sim_config_basaldend = {
                'section' : 'dend',
                'segment' : 0.5,
                'section_num': 70,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                'currents'  : [], #dend (no Ih, no ik_SKv3_1)
                'current_names' : ['Ih','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :[]
                }
#4
sim_config_nexus = {
                'section' : 'apic',
                'segment' : 0,
                'section_num': 77,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['ik_SKv3_1'], #Nexus
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
#5
sim_config_apicaldend = {
                'section' : 'apic',
                'segment' : 0.5,
                'section_num': 90,
                # 'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ik_SKv3_1','ihcn_Ih'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                #'currents'  : ['ihcn_Ih','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # 'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
#################################################################################

def modify_dict_file(filename, changes):
  try:
    # Open the file and read its content
    with open(filename, "r") as file:
      content = file.read()

    # Try to load the content as a dictionary
    try:
      data = eval(content)  # Assuming the file contains valid dictionary syntax
    except (NameError, SyntaxError):
      raise ValueError("Invalid dictionary format in the file.")

    # Modify values based on the provided changes dictionary
    for key, value in changes.items():
      if key not in data:
        print(f"Warning: Key '{key}' not found in the dictionary, skipping.")
      else:
        data[key] = value

    # Write the modified dictionary back to the file
    # with open(filename, "w") as file:
    #   file.write(repr(data))
    with open(filename, "w") as file:
      file.write(json.dumps(data, indent=2))  # Add indentation for readability (optional)

  except IOError as e:
    raise ValueError(f"Error opening or writing file: {e}")
  

  #Don't forget to change NeuronModelClass.py to './Neuron_Model_12HH16HH/' and recompile!!


root_path_out = './Plots/12HH16HH/13-DevelopingModels' ##path for saving your plots
if not os.path.exists(root_path_out): ##make directory if it doens't exist
        os.makedirs(root_path_out)



filename12 = './params/na12annaTFHH2.txt' ##12HH params file that you will update with values below in changesna12
filename16 = './params/na16HH_TF2.txt' ##16HH params file that you will update with values below in changesna16
filenamemut = './params/na12annaTFHHmut.txt' 



## 1.2HH params newest after Kevin's inpurt. 12-16 gap closer to 5mV now.
changesna12={"Rd": 0.023204006298533603, "Rg": 0.015604498120126004, "Rb": 0.0925081211054913, "Ra": 0.23933332265451177, "a0s": 0.0005226303768198727, "gms": 0.14418575154491814, "hmin": 0.008449935591049326, "mmin": 0.01193016441163175, "qinf": 5.7593653647578105, "q10": 2.1532859986639186, "qg": 1.2968193480468215, "qd": 0.661199851452832, "qa1": 4.492758160759386, "smax": 3.5557932199839737, "sh": 8.358558450280716, "thinf": -47.8194205612529, "thi2": -79.6556083820085, "thi1": -62.40165437813537, "tha": -33.850064879126805, "vvs": 1.4255479951467982, "vvh": -55.33213046147061, "vhalfs": -40.89976480829731, "zetas": 13.403615755952343}

## 16HH mod file params can be changed below
changesna16 = {"Rd": 0.03, "Rg": 0.01, "Rb": 0.124, "Ra": 0.4, "a0s": 0.0003, "gms": 0.2, "hmin": 0.01, "mmin": 0.02, "qinf": 7, "q10": 2, "qg": 1.5, "qd": 0.5, "qa1": 7.2, "smax": 10, "sh": 8, "thinf": -51.5, "thi2": -47.5, "thi1": -47.5, "tha": -33.5, "vvs": 2, "vvh": -58, "vhalfs": -26.5, "zetas": 12}

modify_dict_file(filename12, changesna12)
modify_dict_file(filename16, changesna16)


config_dict = {"sim_config_soma": sim_config_soma,
              "sim_config_ais": sim_config_ais,
              "sim_config_basaldend": sim_config_basaldend,
              "sim_config_nexus": sim_config_nexus,
              "sim_config_apicaldend": sim_config_apicaldend}

config_dict2={"sim_config_nexus": sim_config_nexus,
              "sim_config_apicaldend": sim_config_apicaldend}

config_dict3={"sim_config_soma": sim_config_soma}

for config_name, config in config_dict3.items():
  path = f'cell_6/kpfac'

# for morphology_index,morphoname in morphology_files.items():
#   set_morphology(morphology_index)


allmutsefel = pd.DataFrame()

nav16factor=1 ## remove 1.6 in developing model when only 1.2 present. Params replaced by 12
nav12factor=1 
# kpfac=1.2
for kpfac in [0.01,0.1,0.5,1.2,1.5,2,4]:
  simwt = tf.Na12Model_TF(ais_nav12_fac=5.76*nav12factor,nav12=1.1*nav12factor,
                          ais_nav16_fac=1.08*nav16factor,nav16=1.43*nav16factor,
                          somaK=0.022, KP=3.9375*kpfac, KT=5,
                          ais_ca = 43,ais_Kca = 0.25,
                          soma_na16=0.8*nav16factor,soma_na12=2.56*nav12factor,
                          node_na = 1,
                          dend_nav12=1,
                          na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2',na12mechs = ['na12','na12mut'],
                          na16name = 'na12annaTFHH2',na16mut_name = 'na12annaTFHH2',na16mechs=['na16','na16mut'],params_folder = './params/',
                          plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  # wt_Vm1,_,wt_t1,_ = simwt.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=1000, sim_config = config) #stim_amp=0.5
  # wt_fi=simwt.plot_fi_curve_2line(wt_data=None,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'WT_FI', epochlabel='200ms')

  # NeuronModel.map_connectivity(f"{root_path_out}/{path}/insert12_numbered_connectivity.txt")

  fig_volts,axs = plt.subplots(2,figsize=(cm_to_in(8),cm_to_in(15)))
  simwt.plot_stim(axs = axs[0],stim_amp = 0.3,dt=0.005, clr='cadetblue')
  plot_dvdt_from_volts(simwt.volt_soma, simwt.dt, axs[1],clr='cadetblue')
  fig_volts.savefig(f'{simwt.plot_folder}/kpfac-{kpfac}.pdf') #Change output file path here 

# features_wt = ef.get_features(sim=simwt, prefix=f'{root_path_out}/{path}/WT', mut_name='WT')
# allmutsefel = allmutsefel.append(features_wt, ignore_index=True)

# simwt.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200, pfx='WT')
# simwt.plot_model_FI_Vs_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5], fnpre=f'WT')


# NeuronModel.chandensities(name = f'{root_path_out}/densities_WT') ##TF uncomment to run function and plot channel densities in axon[0]

# migraine={"F257I":{"Rd": 0.028485318424710374, "Rg": 0.018420814026814298, "Rb": 0.05777962337521357, "Ra": 0.21341303335597034, "a0s": 0.00046381351100748496, "gms": 0.1341164855099387, "hmin": 0.006864146828635849, "mmin": 0.007621368015226187, "qinf": 6.486459886532015, "q10": 2.561051746368186, "qg": 1.3943995618682714, "qd": 0.797072687262635, "qa1": 6.540179485338942, "smax": 5.751234160342341, "sh": 9.898965372911075, "thinf": -42.299802571430824, "thi2": -64.0747495998566, "thi1": -48.0852551990378, "tha": -30.139992632180743, "vvs": 0.8468560048684934, "vvh": -53.739541326283735, "vhalfs": -42.22939001512733, "zetas": 12.811495608869796},
# "R1319G":{"Rd": 0.01821017957894782, "Rg": 0.015835927879902578, "Rb": 0.08669778691261865, "Ra": 0.25222138069588795, "a0s": 0.0005998602174497901, "gms": 0.15734865667490094, "hmin": 0.003049022325449447, "mmin": 0.009227432163769297, "qinf": 7.542037850663156, "q10": 1.3991326492121134, "qg": 0.11658354700541385, "qd": 0.41022807889968216, "qa1": 6.23800810747929, "smax": 2.297618044174789, "sh": 9.225725362157418, "thinf": -46.09023665760313, "thi2": -57.0320710747067, "thi1": -62.70708396987019, "tha": -29.27378295119758, "vvs": 0.25717057711770985, "vvh": -58.74304862555019, "vhalfs": -31.258170795759927, "zetas": 10.786789360357215},
#  "K1480E":{"Rd": 0.017988222179818, "Rg": 0.014526835880098123, "Rb": 0.032287886870504066, "Ra": 0.20374071568963156, "a0s": 0.00043332968046547453, "gms": 0.2506541588105391, "hmin": 0.003724133667885614, "mmin": 0.022703936878165614, "qinf": 8.056557948665372, "q10": 2.1947359595099254, "qg": 1.607903072936985, "qd": 0.9369754615041643, "qa1": 6.825173338201797, "smax": 9.756858258324922, "sh": 9.29652730203526, "thinf": -44.454878232047506, "thi2": -78.8896576923306, "thi1": -61.97876376872753, "tha": -25.286365983599477, "vvs": 0.665802756552117, "vvh": -45.45240491205891, "vhalfs": -18.50057219270583, "zetas": 11.579233310014331},}

# # e9 ={"E999K":{"Rd": 0.026143636968066552, "Rg": 0.01668223028930355, "Rb": 0.014291884348195151, "Ra": 0.3173306743768715, "a0s": 0.0005030781620195419, "gms": 0.2257551972957173, "hmin": 0.01486999595016371, "mmin": 0.01069596553673631, "qinf": 4.543449675893968, "q10": 2.905858138508142, "qg": 1.070567987818106, "qd": 0.8859991427475545, "qa1": 2.7332610992423385, "smax": 4.562540093135402, "sh": 8.697260358969865, "thinf": -40.098974160495985, "thi2": -79.86939611595125, "thi1": -59.571867025996255, "tha": -25.969320595959655, "vvs": 0.05603301531867544, "vvh": -47.92236852687354, "vhalfs": -24.29418118596604, "zetas": 11.472449828098517},
# # }

# for mutname,dict in migraine.items():
#   print(f"mutname is {mutname}")
#   print(f"it's corresponding dictionary is {dict}")
#   modify_dict_file(filenamemut,dict)
# #   # modify_dict_file(filename16,dict)
#   simmut = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08*nav16factor,
#                               nav12=1.1,nav16=1.43*nav16factor, somaK=0.022, KP=5.625, KT=5, #KP=5.625 - less excitable original, KP=3.9375 - more excitable for kevin paper
#                               ais_ca = 43,ais_Kca = 0.25,
#                               soma_na16=0.8*nav16factor,soma_na12=2.56,node_na = 1,
#                               dend_nav12=1,
#                               na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHHmut',na12mechs = ['na12','na12mut'],
#                               na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
#                               plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
#   simmut.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5],stim_dur=1000, fnpre=f'{mutname}-longerstim')















# synthmuts={
# "mut1_1":{"Rd": 0.02272444169659522, "Rg": 0.019553312622589032, "Rb": 0.16770331931296686, "Ra": 0.11188243238868065, "a0s": 2.4801006789184173e-05, "gms": 0.1879043651340371, "hmin": 0.015552505242279318, "mmin": 0.016035670954010046, "qinf": 5.536939479129174, "q10": 1.9572107962709144, "qg": 2.1511731440409796, "qd": 0.48924773201606253, "qa1": 4.229155545215898, "smax": 5.290014745061671, "sh": 9.450089257757648, "thinf": -47.42140381505649, "thi2": -52.15018021278878, "thi1": -68.88660486702604, "tha": -40.310324540734825, "vvs": 1.386719752356648, "vvh": -44.43780949160364, "vhalfs": -29.329566035875036, "zetas": 11.348588280476964},
# "mut1_2":{"Rd": 0.02539213823390784, "Rg": 0.016264862242915665, "Rb": 0.07126718623175463, "Ra": 0.19879884708981493, "a0s": 0.0004170969165888947, "gms": 0.11970163856973394, "hmin": 0.014294238526914636, "mmin": 0.0020260009680695915, "qinf": 5.65692228922395, "q10": 2.1490554376955515, "qg": 1.144337549069282, "qd": 0.3336852195969187, "qa1": 3.9237581824847347, "smax": 8.77588533259415, "sh": 7.076405632129904, "thinf": -48.014778163996354, "thi2": -67.79794652046922, "thi1": -61.20393893687395, "tha": -33.56259732028026, "vvs": 0.32138025910910195, "vvh": -56.12289624946764, "vhalfs": -21.792199815294254, "zetas": 14.998374333694066},
# "mut1_3":{"Rd": 0.020747267840507885, "Rg": 0.01953968291557014, "Rb": 0.185163106793353, "Ra": 0.3969750563218841, "a0s": 3.617241819166793e-05, "gms": 0.0552136223303412, "hmin": 0.010005714704942763, "mmin": 0.002346599255677269, "qinf": 5.815694619773434, "q10": 2.6612628499912936, "qg": 1.9908846054931808, "qd": 0.9922970520510122, "qa1": 5.994353789553773, "smax": 1.038431290411435, "sh": 9.46711803601288, "thinf": -47.862383801310656, "thi2": -64.8753946581449, "thi1": -63.16644726206884, "tha": -33.64454046635413, "vvs": 1.3470868035502175, "vvh": -38.56190753107943, "vhalfs": -18.537526131777724, "zetas": 12.103976458152282},
# "mut1_4":{"Rd": 0.01279139538757223, "Rg": 0.01803872478809909, "Rb": 0.08328419517108059, "Ra": 0.39498826744678495, "a0s": 0.0004884909811968333, "gms": 0.06746496952005267, "hmin": 0.0041765550399969235, "mmin": 0.019484945734706795, "qinf": 6.3214745364496014, "q10": 1.966713875988559, "qg": 0.7821491452797609, "qd": 0.8320907947009972, "qa1": 5.674623883698654, "smax": 8.43054705977318, "sh": 9.288372565565057, "thinf": -47.113522415940814, "thi2": -77.80704049916578, "thi1": -59.26255618883148, "tha": -29.025701768606623, "vvs": 1.035831178969504, "vvh": -60.82078458741232, "vhalfs": -18.0231745615819, "zetas": 10.955809659345753},
# "mut2_1":{"Rd": 0.02684313158581235, "Rg": 0.015801793009207813, "Rb": 0.11699484607886486, "Ra": 0.20233085306670154, "a0s": 0.00042704318503900565, "gms": 0.09001334661743328, "hmin": 0.008350054291386886, "mmin": 0.015882325421657816, "qinf": 5.706835831392988, "q10": 2.990107499613511, "qg": 1.8167460635719261, "qd": 0.7234241676563119, "qa1": 4.504816544674311, "smax": 7.117517663019491, "sh": 8.438937225174323, "thinf": -48.27653154186925, "thi2": -67.51403378762924, "thi1": -53.60042787523634, "tha": -38.71757305280154, "vvs": 0.9599642254933446, "vvh": -52.66717289528785, "vhalfs": -38.9252382956805, "zetas": 6.746427178965588},
# "mut2_2":{"Rd": 0.024255775751568783, "Rg": 0.008701165748359158, "Rb": 0.14459895567762193, "Ra": 0.20748186502142477, "a0s": 0.0003243488094726221, "gms": 0.17184367997114214, "hmin": 0.01098689768568215, "mmin": 0.018728072149615534, "qinf": 5.849709789721732, "q10": 2.424397510335144, "qg": 0.8733965994552895, "qd": 0.9792211298159677, "qa1": 4.937182527441704, "smax": 5.071454183239197, "sh": 8.992410667909608, "thinf": -48.05918687546327, "thi2": -78.95798621072602, "thi1": -59.40059467833425, "tha": -37.27000659611225, "vvs": 2.0293560418120986, "vvh": -51.20511313878785, "vhalfs": -17.69298165215801, "zetas": 11.509543484042185},
# "mut2_3":{"Rd": 0.025548059322357985, "Rg": 0.01933673886796727, "Rb": 0.12570988450218318, "Ra": 0.31665884242400716, "a0s": 0.00033645795593564224, "gms": 0.18002652744311728, "hmin": 0.0031389676394150356, "mmin": 0.008467213404159537, "qinf": 6.8426073478281015, "q10": 1.8553185106950683, "qg": 0.5752027862496967, "qd": 0.37562757845575845, "qa1": 5.49506249742737, "smax": 4.310539419972767, "sh": 9.713164109181562, "thinf": -48.22302701902775, "thi2": -79.70070222003237, "thi1": -57.57643174898965, "tha": -28.085659910655973, "vvs": 0.7412045619566818, "vvh": -57.25873345076971, "vhalfs": -36.97524902255505, "zetas": 11.70781479655727},
# "mut2_4":{"Rd": 0.02684358036414856, "Rg": 0.019563877755865596, "Rb": 0.053217307439529876, "Ra": 0.3799198421329293, "a0s": 0.0002796983242744826, "gms": 0.18809719031393676, "hmin": 0.011458367441578235, "mmin": 0.012186853886562984, "qinf": 5.866460944630351, "q10": 2.1905890250788707, "qg": 0.9708793202311097, "qd": 0.9126095714390668, "qa1": 5.9253715956321065, "smax": 10.912551627952752, "sh": 7.66606545585998, "thinf": -47.871748416826605, "thi2": -46.890844995440126, "thi1": -53.50397279779055, "tha": -18.419511692694535, "vvs": 1.6931006274649114, "vvh": -52.68336752031714, "vhalfs": -48.15717900885144, "zetas": 10.676639117003722},
# "mut3_1":{"Rd": 0.02420654124881139, "Rg": 0.018275981640593145, "Rb": 0.12205000116881082, "Ra": 0.23014827649468417, "a0s": 0.0005928930820402932, "gms": 0.13910701045909474, "hmin": 0.0013486888446534165, "mmin": 0.009864830605238689, "qinf": 5.978203976050656, "q10": 2.1047410316097674, "qg": 0.38424617984145726, "qd": 0.6882861770641507, "qa1": 2.5291160116059377, "smax": 0.4075202624209099, "sh": 9.282016327962168, "thinf": -47.80993869377147, "thi2": -74.5822220877491, "thi1": -59.78311505894925, "tha": -35.43381032546422, "vvs": 0.43500054361940593, "vvh": -60.68976101992982, "vhalfs": -14.3979756853742, "zetas": 8.326636837881733},
# "mut3_2":{"Rd": 0.0262316120110652, "Rg": 0.014784803374344423, "Rb": 0.07507182302322975, "Ra": 0.24286230672726883, "a0s": 0.00027486727998829767, "gms": 0.16665558303866918, "hmin": 0.004422363179453712, "mmin": 0.014150384904476917, "qinf": 6.366991915185623, "q10": 2.7318157687930484, "qg": 0.21985641709741754, "qd": 0.9820294806477383, "qa1": 4.298926869288, "smax": 2.9792998479426203, "sh": 6.684840614290509, "thinf": -48.05238891474734, "thi2": -74.26046835586358, "thi1": -54.4423839204631, "tha": -31.110263751962766, "vvs": 1.6038736344622762, "vvh": -54.97408000161898, "vhalfs": -26.89608118363291, "zetas": 14.086770735179625},
# "mut3_3":{"Rd": 0.026316053405532648, "Rg": 0.00877603725717044, "Rb": 0.06039571756887732, "Ra": 0.3206042540024077, "a0s": 0.00041522655975733416, "gms": 0.19401926413723752, "hmin": 0.018420624051562032, "mmin": 0.021792918810163136, "qinf": 5.727926944066326, "q10": 1.003821030609663, "qg": 0.5849011655560171, "qd": 0.9885906990422123, "qa1": 6.9993869144058625, "smax": 4.670864113760283, "sh": 8.224442853472977, "thinf": -48.09867762505076, "thi2": -70.99784369463515, "thi1": -58.77896600236174, "tha": -28.778031870401016, "vvs": 1.3980415388566572, "vvh": -59.60487664701626, "vhalfs": -23.90313966503046, "zetas": 8.667900017024147},
# "mut3_4":{"Rd": 0.025546594826588487, "Rg": 0.018707697177648974, "Rb": 0.021023156318577083, "Ra": 0.3556925704190715, "a0s": 0.0003382693467386866, "gms": 0.0964883908400613, "hmin": 0.006475711188140708, "mmin": 0.014765401767768806, "qinf": 5.552005559860685, "q10": 1.7983657052162187, "qg": 1.0299161345645549, "qd": 0.6364657894287031, "qa1": 6.993503881215481, "smax": 8.453774017949998, "sh": 9.099911918747356, "thinf": -48.48842539330547, "thi2": -64.24465533841119, "thi1": -57.438898790388166, "tha": -25.130655777372553, "vvs": 0.41755877200697067, "vvh": -52.4905175904468, "vhalfs": -24.53598621941995, "zetas": 12.565527892456334},
# "mut4_1":{"Rd": 0.026594164371324166, "Rg": 0.017080479974440347, "Rb": 0.03739164059901204, "Ra": 0.276273929555965, "a0s": 0.0004296219818119065, "gms": 0.17113210255663255, "hmin": 0.005433161706909409, "mmin": 0.01903265951875913, "qinf": 5.978390286531405, "q10": 1.2788404812547631, "qg": 0.5465847319029742, "qd": 0.9093358854422314, "qa1": 3.5037045029266967, "smax": 12.180924596816588, "sh": 8.068456903642167, "thinf": -59.332147935422995, "thi2": -41.06363125651824, "thi1": -60.9578873818179, "tha": -32.953258536834745, "vvs": 1.545667809572867, "vvh": -48.15529439379294, "vhalfs": -33.174345517914695, "zetas": 14.579658465125581},
# "mut4_2":{"Rd": 0.022710367655146058, "Rg": 0.013176231370899346, "Rb": 0.07611134133247553, "Ra": 0.252997825343967, "a0s": 0.0005883613002703346, "gms": 0.019760849100713636, "hmin": 0.016915853962223105, "mmin": 0.0151184233081069, "qinf": 5.898802292794844, "q10": 2.439917082901826, "qg": 0.22161568183659386, "qd": 0.6549192797731229, "qa1": 4.602526893355253, "smax": 5.318945928716505, "sh": 7.714412194012942, "thinf": -53.296895962294954, "thi2": -54.48702160139159, "thi1": -57.91192245625123, "tha": -31.83274422045892, "vvs": 0.018027529476035455, "vvh": -59.22042893634617, "vhalfs": -25.77410872232521, "zetas": 10.863712666479993},
# "mut4_3":{"Rd": 0.028749962630467356, "Rg": 0.01502232148156261, "Rb": 0.06809402340521875, "Ra": 0.25616259842461647, "a0s": 0.0003698597037797919, "gms": 0.18211524684597552, "hmin": 0.007342844930241805, "mmin": 0.00998384661231292, "qinf": 5.952963817087748, "q10": 2.683306059259106, "qg": 1.13645281633754, "qd": 0.9690190012361811, "qa1": 4.510137352002093, "smax": 9.528988448787091, "sh": 6.865157898465551, "thinf": -41.655613833908504, "thi2": -61.81778602391779, "thi1": -47.63232776756203, "tha": -29.555475960737166, "vvs": 1.1488423274454842, "vvh": -44.90289646398312, "vhalfs": -51.49224110198424, "zetas": 12.436476607433882},
# "mut4_4":{"Rd": 0.025787892639060558, "Rg": 0.017272597161322577, "Rb": 0.15275991279014128, "Ra": 0.2701281569045194, "a0s": 0.00040114241574576063, "gms": 0.18860215925900792, "hmin": 0.0006823622666883302, "mmin": 0.014858945392257319, "qinf": 5.455751646950046, "q10": 2.647404618676528, "qg": 0.9046733185565552, "qd": 0.8956674583313566, "qa1": 5.245591225522676, "smax": 9.796836748472233, "sh": 8.139379503550233, "thinf": -35.56819911925585, "thi2": -69.40606274291694, "thi1": -52.446928080562195, "tha": -32.35545599907015, "vvs": 1.7438038118425294, "vvh": -56.29016898197952, "vhalfs": -26.910457539251997, "zetas": 14.747863704331994},
# "mut5_1":{"Rd": 0.026298579037903603, "Rg": 0.017817041371817038, "Rb": 0.10193253897725527, "Ra": 0.25894848724244335, "a0s": 0.0003757712661497707, "gms": 0.25910675441788356, "hmin": 0.017018102675510648, "mmin": 0.002865082749443175, "qinf": 5.608483092929883, "q10": 2.4920349449942742, "qg": 0.2649124059306387, "qd": 0.6395256522338056, "qa1": 5.1221333127728546, "smax": 2.2616110921106833, "sh": 8.564521628307986, "thinf": -48.41142729645352, "thi2": -64.29264257603687, "thi1": -52.57599862729806, "tha": -32.56583936727461, "vvs": 0.22390921188333324, "vvh": -47.988906170235694, "vhalfs": -25.90936834533675, "zetas": 9.055736081179015},
# "mut5_2":{"Rd": 0.02615898713507746, "Rg": 0.011842398969920571, "Rb": 0.09552628381533619, "Ra": 0.274439584384361, "a0s": 0.000471241627667728, "gms": 0.13824519882262967, "hmin": 0.010539380917364909, "mmin": 0.026362483347880064, "qinf": 5.213851654622983, "q10": 1.2927119698501708, "qg": 1.0231639387377753, "qd": 0.8953753536658284, "qa1": 4.619524643109753, "smax": 3.8976011536787434, "sh": 9.99705486187338, "thinf": -47.96042457073117, "thi2": -72.3635699170163, "thi1": -59.32661001866801, "tha": -34.79559854346005, "vvs": 1.419745466930392, "vvh": -56.342375164515666, "vhalfs": -30.386219049906042, "zetas": 10.319069363276482},
# "mut5_3":{"Rd": 0.02845363836342061, "Rg": 0.006793295216740819, "Rb": 0.07909425591773929, "Ra": 0.272745197324542, "a0s": 1.001763193657819e-05, "gms": 0.16191897898256205, "hmin": 0.0019397693560741012, "mmin": 0.0022226054196114106, "qinf": 6.452539228111169, "q10": 2.425441171814546, "qg": 0.06279447725849956, "qd": 0.7578753409780983, "qa1": 5.114115150660306, "smax": 8.530344961838109, "sh": 5.9533242555531425, "thinf": -47.75842990657317, "thi2": -18.124424753040216, "thi1": -50.599507485633346, "tha": -29.013593108119537, "vvs": 0.5260400587972068, "vvh": -32.77489170746466, "vhalfs": -35.6245784484663, "zetas": 9.74817838732672},
# "mut5_4":{"Rd": 0.023308162134231987, "Rg": 0.014051306868640555, "Rb": 0.16241882148346987, "Ra": 0.22915744494177298, "a0s": 0.000552553937896734, "gms": 0.15110006263961212, "hmin": 0.0006625735898927741, "mmin": 0.006789733201064843, "qinf": 7.145722424626494, "q10": 2.6079533625806777, "qg": 1.0052960692892365, "qd": 0.8874147067306719, "qa1": 5.149036412207406, "smax": 3.5689332535780447, "sh": 8.814673495215246, "thinf": -47.705457356720004, "thi2": -58.1182296873907, "thi1": -62.759352662394186, "tha": -35.76686608350506, "vvs": 2.708142044835599, "vvh": -60.998636249818304, "vhalfs": -45.26180935628029, "zetas": 14.778679986721514},
# "mut9_1":{"Rd": 0.025724442372274756, "Rg": 0.012402238982136117, "Rb": 0.1050972767813938, "Ra": 0.24027166920363835, "a0s": 0.0005980327693082478, "gms": 0.20591794938957447, "hmin": 0.00951128703431325, "mmin": 0.0002338365600418014, "qinf": 6.401577877887247, "q10": 2.414532216922286, "qg": 0.7105588994467368, "qd": 0.8015664509536542, "qa1": 4.774829619633766, "smax": 6.1871758457077775, "sh": 9.585907744703144, "thinf": -48.219165993032696, "thi2": -79.92351873798863, "thi1": -55.879362354971036, "tha": -34.523653919148906, "vvs": 1.17217033071014, "vvh": -57.46210275215874, "vhalfs": -17.45234868268568, "zetas": 14.214742561246604},
# "mut9_2":{"Rd": 0.025724442372274756, "Rg": 0.012402238982136117, "Rb": 0.1050972767813938, "Ra": 0.24027166920363835, "a0s": 0.0005980327693082478, "gms": 0.20591794938957447, "hmin": 0.00951128703431325, "mmin": 0.0002338365600418014, "qinf": 6.401577877887247, "q10": 2.414532216922286, "qg": 0.7105588994467368, "qd": 0.8015664509536542, "qa1": 4.774829619633766, "smax": 6.1871758457077775, "sh": 9.585907744703144, "thinf": -48.219165993032696, "thi2": -79.92351873798863, "thi1": -55.879362354971036, "tha": -34.523653919148906, "vvs": 1.17217033071014, "vvh": -57.46210275215874, "vhalfs": -17.45234868268568, "zetas": 14.214742561246604},
# "mut9_3":{"Rd": 0.025724442372274756, "Rg": 0.012402238982136117, "Rb": 0.1050972767813938, "Ra": 0.24027166920363835, "a0s": 0.0005980327693082478, "gms": 0.20591794938957447, "hmin": 0.00951128703431325, "mmin": 0.0002338365600418014, "qinf": 6.401577877887247, "q10": 2.414532216922286, "qg": 0.7105588994467368, "qd": 0.8015664509536542, "qa1": 4.774829619633766, "smax": 6.1871758457077775, "sh": 9.585907744703144, "thinf": -48.219165993032696, "thi2": -79.92351873798863, "thi1": -55.879362354971036, "tha": -34.523653919148906, "vvs": 1.17217033071014, "vvh": -57.46210275215874, "vhalfs": -17.45234868268568, "zetas": 14.214742561246604},
# "mut9_4":{"Rd": 0.025724442372274756, "Rg": 0.012402238982136117, "Rb": 0.1050972767813938, "Ra": 0.24027166920363835, "a0s": 0.0005980327693082478, "gms": 0.20591794938957447, "hmin": 0.00951128703431325, "mmin": 0.0002338365600418014, "qinf": 6.401577877887247, "q10": 2.414532216922286, "qg": 0.7105588994467368, "qd": 0.8015664509536542, "qa1": 4.774829619633766, "smax": 6.1871758457077775, "sh": 9.585907744703144, "thinf": -48.219165993032696, "thi2": -79.92351873798863, "thi1": -55.879362354971036, "tha": -34.523653919148906, "vvs": 1.17217033071014, "vvh": -57.46210275215874, "vhalfs": -17.45234868268568, "zetas": 14.214742561246604},
# "mut10_1":{"Rd": 0.02925037087294474, "Rg": 0.011197548324149672, "Rb": 0.1361302311367952, "Ra": 0.3332667927259678, "a0s": 0.0005792700610155251, "gms": 0.09926775722222875, "hmin": 0.007708218429240257, "mmin": 0.01431851166684976, "qinf": 5.6875264288538565, "q10": 2.0185526810092305, "qg": 0.7923256072330952, "qd": 0.9707667685855021, "qa1": 4.367205017586635, "smax": 6.133210647528728, "sh": 7.016004773347081, "thinf": -47.887123532885, "thi2": -71.55337044898344, "thi1": -70.01539396313916, "tha": -33.20128134181031, "vvs": 0.7683874550769767, "vvh": -55.616178089194655, "vhalfs": -14.07537277721423, "zetas": 9.938784796933325},
# "mut10_2":{"Rd": 0.023620201913309134, "Rg": 0.019106330565648914, "Rb": 0.06778852180091831, "Ra": 0.24965713908580928, "a0s": 0.0004013202502247336, "gms": 0.19779195012275233, "hmin": 0.010073094512562053, "mmin": 0.01470538378098885, "qinf": 5.816059648836702, "q10": 1.591185171188449, "qg": 0.15565181321851332, "qd": 0.7581737963257247, "qa1": 4.689384483797035, "smax": 5.28196909858506, "sh": 9.791526721070127, "thinf": -47.915099179408045, "thi2": -63.52154245272316, "thi1": -57.875414218681854, "tha": -33.6671342559767, "vvs": 0.268071212759168, "vvh": -52.91800450073093, "vhalfs": -44.182374112247984, "zetas": 7.603812299664281},
# "mut10_3":{"Rd": 0.014298625851888505, "Rg": 0.018720182172918178, "Rb": 0.12615711633146903, "Ra": 0.12143827098308926, "a0s": 0.0004349169773804185, "gms": 0.021536676499230682, "hmin": 0.005299354880395325, "mmin": 0.017424257761434227, "qinf": 5.686082026696657, "q10": 1.665188087758474, "qg": 2.0653708462238156, "qd": 0.7114180791900926, "qa1": 6.424149570005536, "smax": 2.2020799857679654, "sh": 8.332555617208763, "thinf": -47.98370022175423, "thi2": -32.5378348924385, "thi1": -50.84046481268502, "tha": -36.06954753318082, "vvs": 2.011697205978884, "vvh": -50.4769343026852, "vhalfs": -54.24028670092837, "zetas": 12.486139042433841},
# "mut10_4":{"Rd": 0.010877091961279782, "Rg": 0.016505608375279212, "Rb": 0.07544299573142574, "Ra": 0.09554061746497629, "a0s": 1.9761869777540765e-05, "gms": 0.2533341577385106, "hmin": 0.014250288889124076, "mmin": 0.011580317178179788, "qinf": 6.337294549901939, "q10": 2.1793201115597096, "qg": 0.4247353727247124, "qd": 0.6710012740275081, "qa1": 5.6325258797763675, "smax": 12.923514507505546, "sh": 9.611481417323661, "thinf": -47.98895943930874, "thi2": -72.56620555299784, "thi1": -57.11451989654079, "tha": -36.4560740934281, "vvs": 1.1446181573986949, "vvh": -50.8748854258851, "vhalfs": -64.48195196759883, "zetas": 13.649749008824752},
# "mut11_1":{"Rd": 0.024294502406315307, "Rg": 0.010583815656716603, "Rb": 0.09129165043642505, "Ra": 0.23882600393883535, "a0s": 0.00024537967184770724, "gms": 0.21614113691786074, "hmin": 0.0005726175768125474, "mmin": 0.010899460969862801, "qinf": 5.828498337844369, "q10": 2.5453597334943243, "qg": 0.7121562179078024, "qd": 0.7080595137472917, "qa1": 4.9358619467375515, "smax": 13.828078998340109, "sh": 9.819145235919914, "thinf": -47.814363937564686, "thi2": -75.12575786224083, "thi1": -57.8292822443863, "tha": -34.538454767745016, "vvs": 1.1379080648522546, "vvh": -53.90634331257345, "vhalfs": -14.001852654893826, "zetas": 10.570406024517156},
# "mut11_2":{"Rd": 0.02304455505804343, "Rg": 0.01749515611463603, "Rb": 0.15342060987037742, "Ra": 0.22377397731151485, "a0s": 2.35579424026684e-05, "gms": 0.2672165919470244, "hmin": 0.012976997785279314, "mmin": 0.01046966384213514, "qinf": 5.756657628432828, "q10": 2.14956657967147, "qg": 0.926165350886113, "qd": 0.9106397612677337, "qa1": 5.031464484943239, "smax": 13.075398279640936, "sh": 9.673182109765406, "thinf": -47.6675822328347, "thi2": -77.56449160490257, "thi1": -62.61482852263755, "tha": -36.56936523243027, "vvs": 0.6726816187870107, "vvh": -59.300777482344024, "vhalfs": -10.578307515005907, "zetas": 9.737370098913384},
# "mut11_3":{"Rd": 0.026311938877752197, "Rg": 0.015291365814952981, "Rb": 0.1319295916023124, "Ra": 0.2491898092230208, "a0s": 0.000374504078591662, "gms": 0.2496301944524805, "hmin": 0.003334906640163264, "mmin": 0.01299848452545659, "qinf": 6.203190445650436, "q10": 1.6312667924354423, "qg": 0.6538340484019635, "qd": 0.7771956078888825, "qa1": 5.096593047620961, "smax": 10.874762695756688, "sh": 7.5647860090314865, "thinf": -48.00395957226581, "thi2": -79.63326351444367, "thi1": -55.95732894253402, "tha": -32.95981699394407, "vvs": 0.008034464907729244, "vvh": -47.878890897002, "vhalfs": -23.584804324670266, "zetas": 0.7396426927346194},
# "mut11_4":{"Rd": 0.025282600065963483, "Rg": 0.011181782353908315, "Rb": 0.07877149021958535, "Ra": 0.2513043321506233, "a0s": 0.0004159440080136202, "gms": 0.20165564808132072, "hmin": 0.01949776395892079, "mmin": 0.01247695780445508, "qinf": 5.5873696431746085, "q10": 2.211101583001237, "qg": 1.2234304563622118, "qd": 0.375568061834534, "qa1": 4.650848383599025, "smax": 8.721824697448206, "sh": 8.74102286631959, "thinf": -47.76856153970093, "thi2": -38.16947089330086, "thi1": -57.814650280137016, "tha": -33.384127815975056, "vvs": 0.9115483129632149, "vvh": -54.34030267698349, "vhalfs": -18.46807915434423, "zetas": 13.253047155027083},
# "mut12_1":{"Rd": 0.024720154415434552, "Rg": 0.018028425661624613, "Rb": 0.11380908370660686, "Ra": 0.23699503500251687, "a0s": 0.0002901429257308911, "gms": 0.18686097256690967, "hmin": 0.01383967475314931, "mmin": 0.005020636861641627, "qinf": 5.69386108205276, "q10": 2.224241511611731, "qg": 1.3821607256040536, "qd": 0.9778006440848347, "qa1": 4.818581933700833, "smax": 10.189755145037841, "sh": 7.72333469509566, "thinf": -47.88151217587147, "thi2": -60.63172089976469, "thi1": -57.59990701255916, "tha": -33.15957224063189, "vvs": 0.583894055421289, "vvh": -44.447532712759546, "vhalfs": -29.925672817340576, "zetas": 14.837777775448462},
# "mut12_2":{"Rd": 0.02744215401747794, "Rg": 0.013724669873943104, "Rb": 0.11798590365963538, "Ra": 0.2575061374991893, "a0s": 0.00021185439060562164, "gms": 0.19768746201350956, "hmin": 0.0007039646618955371, "mmin": 0.013658814207612302, "qinf": 5.569123017629465, "q10": 2.8519006135509026, "qg": 0.4999785045567122, "qd": 0.858025434614637, "qa1": 5.635157597265365, "smax": 6.750578328087608, "sh": 9.934733470330407, "thinf": -47.9428236593088, "thi2": -55.12206257934958, "thi1": -53.30164507294198, "tha": -34.65496627855245, "vvs": 1.4685186181977814, "vvh": -59.33957759277455, "vhalfs": -10.733124311161466, "zetas": 12.968601511537964},
# "mut12_3":{"Rd": 0.026142058705206105, "Rg": 0.019866885290558384, "Rb": 0.061895058538106174, "Ra": 0.27009978929276024, "a0s": 0.0005283916660905223, "gms": 0.12181212025656826, "hmin": 0.012735392704874001, "mmin": 0.008771388550581054, "qinf": 6.045788367057046, "q10": 2.538082583168175, "qg": 0.9933320760339781, "qd": 0.8755090306886261, "qa1": 4.272296506754877, "smax": 0.48118157879662515, "sh": 6.337925231264073, "thinf": -47.92381574816813, "thi2": -68.77550985279592, "thi1": -54.514246938787124, "tha": -29.85423299386167, "vvs": 1.0183964850836311, "vvh": -57.26142719931541, "vhalfs": -27.44188335217487, "zetas": 14.714002514530646},
# "mut12_4":{"Rd": 0.02848830957015073, "Rg": 0.017920288232627524, "Rb": 0.07584414429142777, "Ra": 0.25298184954858416, "a0s": 0.00024016222017944134, "gms": 0.056371552016566955, "hmin": 0.003939106112054973, "mmin": 0.007774416333231421, "qinf": 5.7381817490450375, "q10": 2.4069457527425504, "qg": 0.08895001762541088, "qd": 0.9936571912524743, "qa1": 4.7641269763842855, "smax": 13.443348110571176, "sh": 7.816544273685546, "thinf": -47.865012506888945, "thi2": -42.14702114139171, "thi1": -48.69279065412408, "tha": -31.189788720642483, "vvs": 1.5250529682538327, "vvh": -60.711370331574564, "vhalfs": -11.317823554253446, "zetas": 8.411574870909128},}




# for mutname,dict in synthmuts.items():
#   print(f"mutname is {mutname}")
#   print(f"it's corresponding dictionary is {dict}")
#   modify_dict_file(filenamemut,dict)
# #   # modify_dict_file(filename16,dict)


# # for factor in [0.00001,0.0001,0.001,0.01,0.1,0.25,0.5,0.75,1,1.2,2,4,6,10,25,50,100,1000,10000,100000]:
# # for amps in np.arange(-0.4,0.4,0.05):
# # for factor in [0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]:

# ##Mutant/Variant
#   simmut = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08,
#                               nav12=1.1,nav16=1.43, somaK=0.022, KP=3.9375, KT=5,
#                               ais_ca = 43,ais_Kca = 0.25,
#                               soma_na16=0.8,soma_na12=2.56,node_na = 1,
#                               dend_nav12=1,
#                               na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2mut',na12mechs = ['na12','na12mut'],
#                               na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
#                               plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
#   # simmut.wtvsmut_stim_dvdt(wt_Vm=wt_Vm1,wt_t=wt_t1,sim_config=sim_config_soma,vs_amp=[0.5],stim_dur=1700, fnpre=f'{mutname}-')
#   features_df1 = ef.get_features(sim=simmut, prefix=f'{root_path_out}/{path}', mut_name = f'{mutname}')

#   allmutsefel = allmutsefel.append(features_df1,ignore_index=True)
# allmutsefel.to_csv(f'{root_path_out}/{path}/allsynthmuts_EFEL_111524b.csv')
  
