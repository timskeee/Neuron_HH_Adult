from NeuronModelClass import NeuronModel
from NrnHelper import *
import NrnHelper as nh
import matplotlib.pyplot as plt
import matplotlib.cm as cm
import sys
from pathlib import Path
import numpy as np
from Na12HMMModel_TF import *
import Na12HMMModel_TF as tf
import os
import efel_feature_extractor as ef
from currentscape.currentscape import plot_currentscape
import logging
import pandas as pd
# import Document as doc
# import Tim_ng_functions as nf


# 1
sim_config_soma = {
                'section' : 'soma',
                'segment' : 0.5,
                'section_num': 0,
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'],
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                'ionic_concentrations' :["cai", "ki", "nai"]
                }
# 2
sim_config_ais = {
                'section' : 'axon',
                'segment' : 0.1,
                'section_num': 0,
                # 'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_K_Pst','ik_K_Tst','ik_SK_E2','ik_SKv3_1',
                               'na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','i_pas'], #AIS (no Ih)
                'current_names' : ['Ca_HVA','Ca_LVAst','K_Pst','K_Tst','SK_E2','SKv3_1','Na12','Na12 MUT','Na16 WT','Na16 MUT','pas'],
                'ionic_concentrations' :["ki", "nai","cai"]
                }
# 3
sim_config_basaldend = {
                'section' : 'dend',
                'segment' : 0.5,
                'section_num': 70,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ik_SK_E2','ik_SKv3_1'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                'currents'  : [], #dend (no Ih, no ik_SKv3_1)
                'current_names' : ['Ih','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :[]
                }
#4
sim_config_nexus = {
                'section' : 'apic',
                'segment' : 0,
                'section_num': 77,
                #'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['ik_SKv3_1'], #Nexus
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                
                'current_names' : ['Ih','SKv3_1','Na16 WT','Na16 WT','Na12','Na12 MUT','pas'],
                #'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }
#5
sim_config_apicaldend = {
                'section' : 'apic',
                'segment' : 0.5,
                'section_num': 90,
                # 'currents' : ['ina','ica','ik'],
                #'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ica_Ca_HVA','ica_Ca_LVAst','ihcn_Ih','ik_SK_E2','ik_SKv3_1'], #Somatic
                'currents'  : ['na12.ina_ina','na12mut.ina_ina','na16.ina_ina','na16mut.ina_ina','ik_SKv3_1','ihcn_Ih'], #AIS (no Ih)
                #'currents'  : ['ica_Ca_HVA','ica_Ca_LVAst','ik_SKv3_1','ik_SK_E2','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                #'currents'  : ['ihcn_Ih','na16.ina_ina','na16mut.ina_ina','na12.ina_ina','na12mut.ina_ina','i_pas'],
                # 'ionic_concentrations' :["cai", "ki", "nai"]
                'ionic_concentrations' :["ki", "nai"]
                }



def modify_dict_file(filename, changes):
  """
  Modifies values in a dictionary stored in a text file.

  Args:
      filename: The name of the text file containing the dictionary.
      changes: A dictionary containing key-value pairs where the key is the key to modify in the original dictionary and the value is the new value.

  Raises:
      ValueError: If the file cannot be opened or the content is not valid JSON.
  """

  try:
    # Open the file and read its content
    with open(filename, "r") as file:
      content = file.read()

    # Try to load the content as a dictionary
    try:
      data = eval(content)  # Assuming the file contains valid dictionary syntax
    except (NameError, SyntaxError):
      raise ValueError("Invalid dictionary format in the file.")

    # Modify values based on the provided changes dictionary
    for key, value in changes.items():
      if key not in data:
        print(f"Warning: Key '{key}' not found in the dictionary, skipping.")
      else:
        data[key] = value

    # Write the modified dictionary back to the file
    # with open(filename, "w") as file:
    #   file.write(repr(data))
    with open(filename, "w") as file:
      file.write(json.dumps(data, indent=2))  # Add indentation for readability (optional)

  except IOError as e:
    raise ValueError(f"Error opening or writing file: {e}")
  

  #Don't forget to change NeuronModelClass.py to './Neuron_Model_12HH16HH/' and recompile!!


root_path_out = './Plots/12HH16HH/' ##path for saving your plots
if not os.path.exists(root_path_out): ##make directory if it doens't exist
        os.makedirs(root_path_out)



filename12 = './params/na12annaTFHH.txt' ##12HH params file that you will update with values below in changesna12
filename16 = './params/na16HH_TF.txt' ##16HH params file that you will update with values below in changesna16
filenamemut = './params/na12annaTFHH2mut.txt' 


changesna12={"Rd": 0.023204006298533603, "Rg": 0.015604498120126004, "Rb": 0.0925081211054913, "Ra": 0.23933332265451177, "a0s": 0.0005226303768198727, "gms": 0.14418575154491814, "hmin": 0.008449935591049326, "mmin": 0.01193016441163175, "qinf": 5.7593653647578105, "q10": 2.1532859986639186, "qg": 1.2968193480468215, "qd": 0.661199851452832, "qa": 5.41, "smax": 3.5557932199839737, "sh": 8.358558450280716, "thinf": -47.8194205612529, "thi2": -79.6556083820085, "thi1": -62.40165437813537, "tha": -33.850064879126805, "vvs": 1.4255479951467982, "vvh": -55.33213046147061, "vhalfs": -40.89976480829731, "zetas": 13.403615755952343}

## 16HH mod file params can be changed below
changesna16 = {"Rd": 0.03, "Rg": 0.01, "Rb": 0.124, "Ra": 0.4, "a0s": 0.0003, "gms": 0.2, "hmin": 0.01, "mmin": 0.02, "qinf": 7, "q10": 2, "qg": 1.5, "qd": 0.5, "qa": 7.2, "smax": 10, "sh": 8, "thinf": -51.5, "thi2": -47.5, "thi1": -47.5, "tha": -33.5, "vvs": 2, "vvh": -58, "vhalfs": -26.5, "zetas": 12}


modify_dict_file(filename12, changesna12)
modify_dict_file(filename16, changesna16)


config_dict3={"sim_config_soma": sim_config_soma}
# config_dict = {"sim_config_soma": sim_config_soma,
#               "sim_config_ais": sim_config_ais,
#               "sim_config_basaldend": sim_config_basaldend,
#               "sim_config_nexus": sim_config_nexus,
#               "sim_config_apicaldend": sim_config_apicaldend}





## Compiled best synthetic mutants, reordered and renamed to maximize gradients
# bestsynthmuts_REORDERED_021125={  
# "mut1_1":{"Rd": 0.02735697744172416, "Rg": 0.015153179764486211, "Rb": 0.06839644002628642, "Ra": 0.06545839275251729, "a0s": 3.891225904362574e-05, "gms": 0.15058560674306543, "hmin": 0.011630227927729742, "mmin": 0.023810464774892803, "qinf": 4.953081496370763, "q10": 2.074518025347742, "qg": 0.7502977896607076, "qd": 0.6883898348664786, "qa": 2.7160304672592126, "smax": 11.001447404597304, "sh": 5.318004929952289, "thinf": -46.65398181437308, "thi2": -77.38739373440524, "thi1": -58.672057291319454, "tha": -36.45013125792124, "vvs": 0.647108419223072, "vvh": -52.38278563203291, "vhalfs": -19.732784818992535, "zetas": 7.744543181377883},
# "mut1_2":{"Rd": 0.02594476158027297, "Rg": 0.016144431280642628, "Rb": 0.08934874404499142, "Ra": 0.16955803482132703, "a0s": 0.0004816490190548648, "gms": 0.17657142204886436, "hmin": 0.011589238863086222, "mmin": 0.0020468307283586407, "qinf": 5.72480797567882, "q10": 2.126883063020522, "qg": 1.0550281012362688, "qd": 0.7957144411164588, "qa": 4.4420954997824, "smax": 8.328502613289725, "sh": 6.8855552474954, "thinf": -48.16967323400767, "thi2": -77.97268936268561, "thi1": -60.82758816155663, "tha": -34.220992265623266, "vvs": 0.43213361946621226, "vvh": -59.77746418772454, "vhalfs": -53.44866473720053, "zetas": 7.9704174533021614},
# "mut1_3":{"Rd": 0.029910943918873223, "Rg": 0.016428398412077293, "Rb": 0.16173505702988325, "Ra": 0.24829596063363163, "a0s": 0.0005436590706842545, "gms": 0.051976717951927945, "hmin": 0.00488024520875049, "mmin": 0.024338855308029886, "qinf": 5.795340579723236, "q10": 2.3663769919534694, "qg": 1.2376290094021916, "qd": 0.4032969286195285, "qa": 3.4123906974637475, "smax": 12.936425856666109, "sh": 9.039282419735736, "thinf": -47.321214965085595, "thi2": -11.488472132074708, "thi1": -40.2056980702163, "tha": -33.95095330231036, "vvs": 0.08465187335372848, "vvh": -60.15969616997436, "vhalfs": -29.355664047162417, "zetas": 10.791244127369858},
# "mut1_4":{"Rd": 0.01326848343047775, "Rg": 0.019476864581928627, "Rb": 0.19781670645310398, "Ra": 0.3979657342587153, "a0s": 0.00047755469569722643, "gms": 0.03231329895137398, "hmin": 0.006518700809069125, "mmin": 0.012455766986134287, "qinf": 5.977141632295028, "q10": 2.9948108477625377, "qg": 2.8439807187898904, "qd": 0.7415243019041889, "qa": 5.769703899444326, "smax": 0.49734159835909064, "sh": 8.87958921500525, "thinf": -47.72740133292891, "thi2": -65.80844381550162, "thi1": -56.62083129092299, "tha": -32.72283539505583, "vvs": 1.023861852540769, "vvh": -55.822517833530945, "vhalfs": -15.790782132646958, "zetas": 11.918730153857336},
# "mut2_1":{"Rd": 0.02629027877428925, "Rg": 0.019132258151435464, "Rb": 0.061714464536991157, "Ra": 0.36313718930004546, "a0s": 0.0003192692544588723, "gms": 0.20788327805576493, "hmin": 0.01625247472025391, "mmin": 0.01605631251953759, "qinf": 5.695317706045491, "q10": 1.1092364311863656, "qg": 1.694992279113578, "qd": 0.9408262731784682, "qa": 5.472999418501854, "smax": 0.44726167195565725, "sh": 9.776252685086588, "thinf": -47.92956945335569, "thi2": -68.8383485029218, "thi1": -75.66873140994214, "tha": -24.154389927746223, "vvs": 1.0758438841035185, "vvh": -41.304704049603174, "vhalfs": -76.71650430791178, "zetas": 13.54065464579179},
# "mut2_2":{"Rd": 0.024568997576556208, "Rg": 0.007317650985823302, "Rb": 0.15580034513261856, "Ra": 0.2074717052509235, "a0s": 0.00035255625529235926, "gms": 0.1882300126160065, "hmin": 0.013776819840234857, "mmin": 0.008760932186315322, "qinf": 5.817681179628916, "q10": 2.8054896844638995, "qg": 0.8199285552640376, "qd": 0.9513397437185004, "qa": 4.935184754699727, "smax": 7.80911971814305, "sh": 8.056820771894524, "thinf": -48.06270001511047, "thi2": -79.89537203368025, "thi1": -57.84717774377759, "tha": -36.36061882114468, "vvs": 1.2623175563216331, "vvh": -50.25675076922547, "vhalfs": -18.10018797925259, "zetas": 11.407939331697118},
# "mut2_3":{"Rd": 0.024568997576556208, "Rg": 0.007317650985823302, "Rb": 0.15580034513261856, "Ra": 0.2074717052509235, "a0s": 0.00035255625529235926, "gms": 0.1882300126160065, "hmin": 0.013776819840234857, "mmin": 0.008760932186315322, "qinf": 5.817681179628916, "q10": 2.8054896844638995, "qg": 0.8199285552640376, "qd": 0.9513397437185004, "qa": 4.935184754699727, "smax": 7.80911971814305, "sh": 8.056820771894524, "thinf": -48.06270001511047, "thi2": -79.89537203368025, "thi1": -57.84717774377759, "tha": -36.36061882114468, "vvs": 1.2623175563216331, "vvh": -50.25675076922547, "vhalfs": -18.10018797925259, "zetas": 11.407939331697118},
# "mut2_4":{"Rd": 0.026488672266575884, "Rg": 0.014521555213498124, "Rb": 0.18467051140036536, "Ra": 0.201854755248321, "a0s": 0.0005126713396771124, "gms": 0.23362102543849317, "hmin": 0.002188524241568054, "mmin": 0.011465694968675786, "qinf": 5.452557549687859, "q10": 2.9951508615325375, "qg": 1.714590410731862, "qd": 0.9455820733103606, "qa": 3.6235354827461483, "smax": 2.51123314930111, "sh": 7.577321951780882, "thinf": -48.115191095696346, "thi2": -28.22215527442445, "thi1": -54.963680366153326, "tha": -38.945544100221525, "vvs": 1.6918621251596284, "vvh": -37.61837241234329, "vhalfs": -33.16787024353937, "zetas": 5.627916084890746},
# "mut3_1":{"Rd": 0.0271363014339307, "Rg": 0.010858549352013669, "Rb": 0.06585295850435718, "Ra": 0.2791135735002921, "a0s": 0.00032438477096202343, "gms": 0.21436332066470745, "hmin": 0.017513977142432767, "mmin": 0.02774675424687434, "qinf": 5.725803082061477, "q10": 1.0016551916921024, "qg": 0.19371017305461524, "qd": 0.9103875523095253, "qa": 6.99999781134728, "smax": 5.152711957150955, "sh": 7.276792427452112, "thinf": -48.03747927872592, "thi2": -65.24021114175424, "thi1": -58.77896600236174, "tha": -28.799011757174775, "vvs": 1.0063483984304196, "vvh": -45.20667242131125, "vhalfs": -46.481059113461704, "zetas": 6.278135363639492},
# "mut3_2":{"Rd": 0.020578446277443114, "Rg": 0.01953710984717185, "Rb": 0.019233233329383644, "Ra": 0.30861755401365626, "a0s": 0.00035156711239535057, "gms": 0.054982483857439785, "hmin": 0.017063211046033012, "mmin": 0.020932334946455085, "qinf": 3.055252593235787, "q10": 1.6412667284258011, "qg": 1.4166523467160155, "qd": 0.6964383359839195, "qa": 6.9983155079130155, "smax": 10.319239709714752, "sh": 9.98385427598464, "thinf": -48.28672076529707, "thi2": -66.07796083260656, "thi1": -72.68847827161825, "tha": -28.96427387769314, "vvs": 1.1415149945100513, "vvh": -54.61209616180672, "vhalfs": -37.32750254108229, "zetas": 14.995060694851347},
# "mut3_3":{"Rd": 0.025909960587237817, "Rg": 0.01301532636717773, "Rb": 0.06928306901315988, "Ra": 0.2400468270505505, "a0s": 0.0004051480377611907, "gms": 0.28985021747569156, "hmin": 0.0009298931489491125, "mmin": 0.0013780814794312262, "qinf": 5.758749071127669, "q10": 2.874963798192262, "qg": 0.0102193830352309, "qd": 0.9286240414247167, "qa": 3.9554726327850527, "smax": 10.162067476469025, "sh": 9.075896915201302, "thinf": -47.85910876010121, "thi2": -60.4155127487862, "thi1": -54.87233064733536, "tha": -33.67926392768192, "vvs": 1.105967394499335, "vvh": -52.19991810402488, "vhalfs": -35.597974686459224, "zetas": 14.843144548991685},
# "mut3_4":{"Rd": 0.021539333456066838, "Rg": 0.01938974273522918, "Rb": 0.13411093301106886, "Ra": 0.21575183395551836, "a0s": 0.0005529087074331134, "gms": 0.21270079991171037, "hmin": 0.010129317989188086, "mmin": 0.02140216916589976, "qinf": 5.747643991342539, "q10": 2.8578458238158424, "qg": 0.48203564020405343, "qd": 0.5211144608706483, "qa": 2.3712675160919576, "smax": 4.6892273830521995, "sh": 9.39478401562331, "thinf": -47.586106971554045, "thi2": -68.95868205440645, "thi1": -61.19254327074351, "tha": -35.45409605226765, "vvs": 1.1666354009954527, "vvh": -42.73456115494698, "vhalfs": -23.613298034423444, "zetas": 11.009713860557477},
# "mut4_1":{"Rd": 0.026384861854339865, "Rg": 0.017216037795361894, "Rb": 0.12837300795550013, "Ra": 0.25353061607003063, "a0s": 4.2410228689384536e-05, "gms": 0.047598201971333035, "hmin": 2.5314573787947516e-05, "mmin": 0.011678299094720596, "qinf": 8.03840395078539, "q10": 1.188898296218245, "qg": 2.2313686936471093, "qd": 0.9923076877510596, "qa": 5.143730738736812, "smax": 0.4338639279533929, "sh": 8.302556502447649, "thinf": -61.98296501231657, "thi2": -79.46450173305057, "thi1": -58.46806411651639, "tha": -33.91750100895857, "vvs": 0.15841285406530475, "vvh": -50.028601292256695, "vhalfs": -58.097564586146376, "zetas": 9.72559058008965},
# "mut4_2":{"Rd": 0.025519311583448303, "Rg": 0.01806790427865722, "Rb": 0.14536347409240222, "Ra": 0.2502352871993136, "a0s": 0.0004482266716084482, "gms": 0.25476569172309727, "hmin": 0.007009950451522886, "mmin": 0.012003514193781189, "qinf": 4.574920476393687, "q10": 1.1476457207741035, "qg": 0.8184153828395149, "qd": 0.8019833921128907, "qa": 4.2160541571770445, "smax": 9.877655307428789, "sh": 8.832427988260633, "thinf": -41.2194849673826, "thi2": -74.26014478651132, "thi1": -57.62507940240592, "tha": -34.484266795766665, "vvs": 0.03466597648718478, "vvh": -57.04382755988163, "vhalfs": -32.696746528263084, "zetas": 7.87226495513529},
# "mut4_3":{"Rd": 0.02399569184508087, "Rg": 0.01736234681500425, "Rb": 0.06796579214920581, "Ra": 0.24624446965793706, "a0s": 0.0003622291377675681, "gms": 0.22215913100281884, "hmin": 0.007684811966850041, "mmin": 0.011263354311723246, "qinf": 6.500767509176027, "q10": 1.9506685569649513, "qg": 0.902226460815369, "qd": 0.9653994204249137, "qa": 4.294582223935696, "smax": 10.993411752090926, "sh": 7.050855813669112, "thinf": -53.47882254794794, "thi2": -78.29383036298663, "thi1": -60.61175386462758, "tha": -32.305266703802594, "vvs": 1.4853241490501752, "vvh": -46.546940967760726, "vhalfs": -12.66123147522818, "zetas": 11.59991821878199},
# "mut4_4":{"Rd": 0.025052849459063147, "Rg": 0.0199945959122063, "Rb": 0.1739638338964311, "Ra": 0.26626158699466906, "a0s": 0.0003502130628134103, "gms": 0.12295077631157378, "hmin": 0.015137265883554222, "mmin": 0.02749013485793254, "qinf": 3.8432845245511356, "q10": 1.607941869392826, "qg": 0.03926409957568844, "qd": 0.7413232627776244, "qa": 5.306667666039221, "smax": 5.577547491712884, "sh": 7.412961945319315, "thinf": -35.44310538816553, "thi2": -67.9475516783775, "thi1": -55.53112330548022, "tha": -32.14875825683306, "vvs": 0.5246979360028227, "vvh": -59.26845090365563, "vhalfs": -48.74952890850776, "zetas": 12.651993154900477},
# "mut5_1":{"Rd": 0.02701119998697379, "Rg": 0.007554313646539795, "Rb": 0.08216524515733808, "Ra": 0.2643532759351036, "a0s": 0.0005791118316328197, "gms": 0.09569139098075205, "hmin": 0.017441209515602008, "mmin": 0.004079127084017231, "qinf": 5.982753017834614, "q10": 2.3603433059614267, "qg": 0.14060902415157334, "qd": 0.46055169561574194, "qa": 5.037269076531583, "smax": 2.3498017637203565, "sh": 8.238211223086939, "thinf": -48.555764886778405, "thi2": -63.39786268469176, "thi1": -53.127136979567126, "tha": -31.5348318373408, "vvs": 1.6060786711953108, "vvh": -46.2496450815056, "vhalfs": -24.38275864219653, "zetas": 12.061354057836986},
# "mut5_2":{"Rd": 0.024720112917881055, "Rg": 0.018541343511408848, "Rb": 0.11259456304121376, "Ra": 0.24712131121970332, "a0s": 0.0004972541639862278, "gms": 0.14061659320270067, "hmin": 0.015502759721939445, "mmin": 0.0026758513976433617, "qinf": 6.203090285648935, "q10": 1.8105567164212135, "qg": 0.0026131733274903646, "qd": 0.6180282819328444, "qa": 5.116746587458819, "smax": 7.324766525525432, "sh": 8.884798383997602, "thinf": -48.126302165543045, "thi2": -23.46761130680343, "thi1": -57.36559608546103, "tha": -33.76958313917315, "vvs": 1.222203774598586, "vvh": -32.45341504947651, "vhalfs": -30.027983577593623, "zetas": 7.295584046622534},
# "mut5_3":{"Rd": 0.024099283532945864, "Rg": 0.017583697354344716, "Rb": 0.10373183010152592, "Ra": 0.22652447463153436, "a0s": 0.0004990826734574562, "gms": 0.11823773635172939, "hmin": 0.01390743040880614, "mmin": 0.0036606094304718374, "qinf": 5.835606664662725, "q10": 2.2353734180224523, "qg": 1.0366340336768565, "qd": 0.5618624753047958, "qa": 4.691898873772695, "smax": 2.1802923692990097, "sh": 8.657605677232198, "thinf": -47.62991303180279, "thi2": -78.49335010452293, "thi1": -59.368805568553846, "tha": -34.22146065050052, "vvs": 0.017447769498914023, "vvh": -48.75974258317825, "vhalfs": -27.441696653845405, "zetas": 13.53270255526033},
# "mut5_4":{"Rd": 0.024002463356996972, "Rg": 0.01899583310300501, "Rb": 0.11558682832893928, "Ra": 0.24594742113961007, "a0s": 0.0003980998585412338, "gms": 0.07385059647142797, "hmin": 0.002370317143968269, "mmin": 0.00038581081425028904, "qinf": 6.088769354858897, "q10": 2.3347981826817135, "qg": 1.5901112115667582, "qd": 0.753841504155426, "qa": 4.7160969489808435, "smax": 4.807659128552935, "sh": 8.853423907562162, "thinf": -47.72412825560719, "thi2": -55.09737320786358, "thi1": -59.89350855435276, "tha": -34.4392676782676, "vvs": 0.10315039523947883, "vvh": -53.8217560426071, "vhalfs": -40.48652139039861, "zetas": 11.594601823841135},
# "mut10_1":{"Rd": 0.025427888508545497, "Rg": 0.01867129230675479, "Rb": 0.08067641172638762, "Ra": 0.2394687009764217, "a0s": 0.00034200332989650027, "gms": 0.10548351315764355, "hmin": 0.001721878528020299, "mmin": 0.015943378274537012, "qinf": 5.952385140097297, "q10": 1.2298407393879724, "qg": 1.6926240924646268, "qd": 0.7602015434301642, "qa": 4.746543975487382, "smax": 4.428924987924885, "sh": 7.689399939938984, "thinf": -48.02516881685639, "thi2": -68.54837800734377, "thi1": -54.39555027048551, "tha": -32.09916894494031, "vvs": 0.012839785406228824, "vvh": -55.176351528001476, "vhalfs": -34.19156599964327, "zetas": 8.98793974393631},
# "mut10_2":{"Rd": 0.018479249784270027, "Rg": 0.01616892761262375, "Rb": 0.05286426454631773, "Ra": 0.12985817805068953, "a0s": 2.8288493393966482e-05, "gms": 0.10502212608962722, "hmin": 0.008599567520185323, "mmin": 0.008917358474255515, "qinf": 6.1900805899006235, "q10": 2.1281611120423802, "qg": 0.46434971436387396, "qd": 0.3032625735170217, "qa": 6.25751655147087, "smax": 3.0514982093913803, "sh": 7.898262215221069, "thinf": -47.70290807827395, "thi2": -28.118306998400087, "thi1": -33.89828989262652, "tha": -28.729965547198262, "vvs": 1.3392504515168708, "vvh": -52.41899200534546, "vhalfs": -11.055561422439292, "zetas": 14.790369980888514},
# "mut10_3":{"Rd": 0.013908932581666932, "Rg": 0.014575092951801703, "Rb": 0.18760211728918308, "Ra": 0.12072519564140358, "a0s": 0.0004985472674731082, "gms": 0.010143402352321734, "hmin": 6.560553546681753e-05, "mmin": 0.027647039892021535, "qinf": 6.117383062665207, "q10": 1.9189604790205586, "qg": 1.0310705933915763, "qd": 0.2766710550665108, "qa": 6.75363247734855, "smax": 3.956389362212434, "sh": 8.672991520900368, "thinf": -47.21893265643665, "thi2": -60.751781707044586, "thi1": -55.786034262344415, "tha": -38.8956417666429, "vvs": 2.5190085323411244, "vvh": -46.209063527481625, "vhalfs": -26.147846554308405, "zetas": 11.549872109450808},
# "mut10_4":{"Rd": 0.027395728264448305, "Rg": 0.019480744967267646, "Rb": 0.13764175491228756, "Ra": 0.3249271716724938, "a0s": 0.0003108982883780263, "gms": 0.07492898371136576, "hmin": 0.018575871305948823, "mmin": 0.018826485307131623, "qinf": 5.694358259122065, "q10": 2.7529370746620305, "qg": 0.36482273291978423, "qd": 0.9929256455655058, "qa": 4.212896480253771, "smax": 1.0915477358638386, "sh": 8.839404835874905, "thinf": -48.00704037156025, "thi2": -50.59206400067486, "thi1": -73.8256011660641, "tha": -35.31387920279738, "vvs": 1.0447778994280894, "vvh": -60.42500565507859, "vhalfs": -20.50066108952194, "zetas": 13.413655031086758},
# "mut11_1":{"Rd": 0.021929866885543, "Rg": 0.01772208016037675, "Rb": 0.10172290726180878, "Ra": 0.24440983158445595, "a0s": 0.0004935602113180277, "gms": 0.1381127098924386, "hmin": 0.0067952192150873125, "mmin": 0.012323186826064238, "qinf": 5.429528389097359, "q10": 2.2392618221594183, "qg": 0.4685311154864299, "qd": 0.6365899397217457, "qa": 4.100733825897971, "smax": 13.9077232347004, "sh": 8.408165494867305, "thinf": -47.75777305201812, "thi2": -77.96373863535196, "thi1": -66.99940757785221, "tha": -34.4805504066182, "vvs": 2.0108543610382807, "vvh": -48.34012571001951, "vhalfs": -28.974566351542382, "zetas": 8.699065029839916},
# "mut11_2":{"Rd": 0.023399942200925325, "Rg": 0.019965436157259105, "Rb": 0.07540978457250698, "Ra": 0.2425151396623956, "a0s": 0.0004582582633983299, "gms": 0.1481485549246561, "hmin": 0.014242232545166386, "mmin": 0.016294071300598584, "qinf": 5.809590563587539, "q10": 2.3186898190865453, "qg": 2.590203157614032, "qd": 0.46913038818651925, "qa": 4.4175193206822465, "smax": 5.138986188281341, "sh": 8.617075165527536, "thinf": -47.74688173180442, "thi2": -78.17190276861996, "thi1": -61.2842877147508, "tha": -33.59370566796033, "vvs": 1.0459406825848059, "vvh": -56.42105481340581, "vhalfs": -29.60456097617442, "zetas": 8.427767048585112},
# "mut11_3":{"Rd": 0.02564061284443833, "Rg": 0.016454713299112786, "Rb": 0.10055904165597555, "Ra": 0.24116104446108555, "a0s": 0.0005665182625568133, "gms": 0.2325358602970435, "hmin": 0.012157008344442369, "mmin": 0.005806104547125069, "qinf": 5.901283391483913, "q10": 2.524586640609418, "qg": 0.8736025508090265, "qd": 0.8611346672394538, "qa": 4.757270560835982, "smax": 11.506898111190113, "sh": 8.798872576220642, "thinf": -48.100165815706426, "thi2": -70.04390653046077, "thi1": -79.9757965536142, "tha": -34.314579389963136, "vvs": 0.24021797968728012, "vvh": -45.9545692482469, "vhalfs": -49.860386242027374, "zetas": 13.7529382260335},
# "mut11_4":{"Rd": 0.02369089815905383, "Rg": 0.008411557890444519, "Rb": 0.0487880328533895, "Ra": 0.17157260073059677, "a0s": 0.00025582958331112407, "gms": 0.12885704931583242, "hmin": 0.009303535999447674, "mmin": 0.026948335934518956, "qinf": 6.133979134314556, "q10": 2.4395947125438777, "qg": 0.10347113488469517, "qd": 0.7004724820031882, "qa": 3.9529743529841057, "smax": 9.393026842614292, "sh": 7.737377293674833, "thinf": -47.68032583551547, "thi2": -33.72623707497113, "thi1": -60.263660406796404, "tha": -34.243539777964415, "vvs": 1.9758347847089923, "vvh": -55.213940227332245, "vhalfs": -10.582542092497823, "zetas": 10.751467859832209},
# "mut12_1":{"Rd": 0.0269169700230419, "Rg": 0.005347068230662407, "Rb": 0.09920725283147158, "Ra": 0.26109164294225423, "a0s": 0.00037581955408674025, "gms": 0.24325485083330284, "hmin": 0.0021755391192732594, "mmin": 0.01080660170954422, "qinf": 6.040884817154375, "q10": 1.4150507250158433, "qg": 1.138025041093626, "qd": 0.8989630852152845, "qa": 4.889924968564757, "smax": 1.9341001262945832, "sh": 6.38171407336664, "thinf": -47.99943274074794, "thi2": -74.66381828125607, "thi1": -55.98612683431803, "tha": -30.91762067327644, "vvs": 1.0604315655779213, "vvh": -59.435470320512486, "vhalfs": -41.7519335575422, "zetas": 11.589784187186154},
# "mut12_2":{"Rd": 0.024960360998484764, "Rg": 0.01459806798243318, "Rb": 0.0965308116834002, "Ra": 0.2476236762645026, "a0s": 0.0003970265495369906, "gms": 0.26908192205699105, "hmin": 0.007002949283398527, "mmin": 0.0020126504372082544, "qinf": 5.86212977573515, "q10": 1.7693069963235182, "qg": 0.42566376175974086, "qd": 0.9348269309637147, "qa": 4.706547613275087, "smax": 0.3616111229538904, "sh": 6.354998108202179, "thinf": -47.80635799237096, "thi2": -75.10834997946692, "thi1": -58.49643913016675, "tha": -31.395524686881505, "vvs": 0.10626923677921263, "vvh": -56.40100376489494, "vhalfs": -35.1625290212924, "zetas": 4.551755258930188},
# "mut12_3":{"Rd": 0.026341829109144867, "Rg": 0.01595747635837312, "Rb": 0.11385415617192195, "Ra": 0.25294958624382163, "a0s": 0.0003569150129602803, "gms": 0.12283361477301487, "hmin": 0.01203624127992991, "mmin": 0.027434699923145837, "qinf": 6.02052583745145, "q10": 2.224591292047369, "qg": 1.7257806606927213, "qd": 0.793295971364335, "qa": 5.364623777926906, "smax": 2.684965115586759, "sh": 7.787220023721729, "thinf": -47.97568300997233, "thi2": -71.68791038210352, "thi1": -56.632696149747105, "tha": -32.8884899922085, "vvs": 0.13072318176479514, "vvh": -44.478187791313346, "vhalfs": -14.23682084873365, "zetas": 13.207234994555186},
# "mut12_4":{"Rd": 0.025865328977864616, "Rg": 0.01717656999787636, "Rb": 0.09138198458434318, "Ra": 0.24226850051330223, "a0s": 7.447219563913707e-06, "gms": 0.2509840296668697, "hmin": 0.014895887171197417, "mmin": 0.013019199823609646, "qinf": 5.9415490073459605, "q10": 2.9078178415770912, "qg": 1.5001201181216812, "qd": 0.8732070577446075, "qa": 4.69430490421596, "smax": 10.588052073819421, "sh": 6.996482926016626, "thinf": -48.045720370651125, "thi2": -69.19614472115914, "thi1": -55.33440183206611, "tha": -31.716011904495094, "vvs": 0.10445927859958029, "vvh": -51.24507714355363, "vhalfs": -11.81638421851683, "zetas": 6.441705936359468},
# "mut13_1":{"Rd": 0.029974392171229224, "Rg": 0.01723878208886209, "Rb": 0.19598636322137022, "Ra": 0.39995837227856523, "a0s": 0.00016631094744527802, "gms": 0.0413964412861661, "hmin": 0.007264199980766417, "mmin": 0.0074126523834307165, "qinf": 3.66417913492673, "q10": 2.9721532173384038, "qg": 1.7348053244590236, "qd": 0.22197117406537867, "qa": 3.021129876809143, "smax": 1.9299089755085368, "sh": 9.880963733806805, "thinf": -52.80928722848205, "thi2": -10.018936084937572, "thi1": -79.84874699913891, "tha": -48.88815778993708, "vvs": 2.9983238755993975, "vvh": -58.38200721906789, "vhalfs": -69.8447949466605, "zetas": 8.049515470375628},
# "mut13_2":{"Rd": 0.028289119185471303, "Rg": 0.016854722880919853, "Rb": 0.19294197772314586, "Ra": 0.39944770850287936, "a0s": 0.00017468173639105538, "gms": 0.11056415641757504, "hmin": 0.0019085075558057587, "mmin": 0.01525467542228769, "qinf": 5.71927987888793, "q10": 2.797446091847996, "qg": 1.4309488443931455, "qd": 0.9681764462009756, "qa": 4.956574665309508, "smax": 5.246893417369555, "sh": 8.143855692622687, "thinf": -46.6145097302023, "thi2": -77.33304511993045, "thi1": -79.89660566761904, "tha": -33.38385015208642, "vvs": 0.2432618106950166, "vvh": -56.229613918181315, "vhalfs": -64.29146078036919, "zetas": 13.295933297399511},
# "mut13_3":{"Rd": 0.014267402851293746, "Rg": 0.015850217229197324, "Rb": 0.14962839423301066, "Ra": 0.06023384478710728, "a0s": 0.00025114869308605234, "gms": 0.1871481102391445, "hmin": 0.010323488536806008, "mmin": 0.015644559361666963, "qinf": 4.5120938008566025, "q10": 2.487611415550795, "qg": 0.8355645676420531, "qd": 0.827198302166888, "qa": 5.381783153855559, "smax": 11.366921127643964, "sh": 8.071359940225756, "thinf": -43.611389014509406, "thi2": -69.33834991280328, "thi1": -72.111139316991, "tha": -43.43512375742244, "vvs": 1.6744532804885472, "vvh": -43.817468581045475, "vhalfs": -20.75694219557058, "zetas": 14.574838796880186},
# "mut13_4":{"Rd": 0.012988426392609989, "Rg": 0.017786306699059905, "Rb": 0.1384695592633962, "Ra": 0.018872850696954862, "a0s": 0.0005307929617695427, "gms": 0.05363336599172791, "hmin": 0.011734614458042043, "mmin": 0.0034437471574469843, "qinf": 7.1934539338187395, "q10": 1.8750070063126019, "qg": 1.2683661982186067, "qd": 0.9587028374398872, "qa": 6.3557624513757895, "smax": 9.27916730538191, "sh": 9.720408518152473, "thinf": -53.88626660536972, "thi2": -78.40736012087147, "thi1": -76.96809140338001, "tha": -50.38737888206187, "vvs": 1.1788504917702238, "vvh": -56.406817229632715, "vhalfs": -46.536377410720625, "zetas": 14.740130258226197},
# }

## Compiled best synthetic mutants
bestsynthmuts012825={  
"mut1_1":{"Rd": 0.02735697744172416, "Rg": 0.015153179764486211, "Rb": 0.06839644002628642, "Ra": 0.06545839275251729, "a0s": 3.891225904362574e-05, "gms": 0.15058560674306543, "hmin": 0.011630227927729742, "mmin": 0.023810464774892803, "qinf": 4.953081496370763, "q10": 2.074518025347742, "qg": 0.7502977896607076, "qd": 0.6883898348664786, "qa": 2.7160304672592126, "smax": 11.001447404597304, "sh": 5.318004929952289, "thinf": -46.65398181437308, "thi2": -77.38739373440524, "thi1": -58.672057291319454, "tha": -36.45013125792124, "vvs": 0.647108419223072, "vvh": -52.38278563203291, "vhalfs": -19.732784818992535, "zetas": 7.744543181377883},
"mut1_2":{"Rd": 0.02594476158027297, "Rg": 0.016144431280642628, "Rb": 0.08934874404499142, "Ra": 0.16955803482132703, "a0s": 0.0004816490190548648, "gms": 0.17657142204886436, "hmin": 0.011589238863086222, "mmin": 0.0020468307283586407, "qinf": 5.72480797567882, "q10": 2.126883063020522, "qg": 1.0550281012362688, "qd": 0.7957144411164588, "qa": 4.4420954997824, "smax": 8.328502613289725, "sh": 6.8855552474954, "thinf": -48.16967323400767, "thi2": -77.97268936268561, "thi1": -60.82758816155663, "tha": -34.220992265623266, "vvs": 0.43213361946621226, "vvh": -59.77746418772454, "vhalfs": -53.44866473720053, "zetas": 7.9704174533021614},
"mut1_3":{"Rd": 0.01326848343047775, "Rg": 0.019476864581928627, "Rb": 0.19781670645310398, "Ra": 0.3979657342587153, "a0s": 0.00047755469569722643, "gms": 0.03231329895137398, "hmin": 0.006518700809069125, "mmin": 0.012455766986134287, "qinf": 5.977141632295028, "q10": 2.9948108477625377, "qg": 2.8439807187898904, "qd": 0.7415243019041889, "qa": 5.769703899444326, "smax": 0.49734159835909064, "sh": 8.87958921500525, "thinf": -47.72740133292891, "thi2": -65.80844381550162, "thi1": -56.62083129092299, "tha": -32.72283539505583, "vvs": 1.023861852540769, "vvh": -55.822517833530945, "vhalfs": -15.790782132646958, "zetas": 11.918730153857336},
"mut1_4":{"Rd": 0.029910943918873223, "Rg": 0.016428398412077293, "Rb": 0.16173505702988325, "Ra": 0.24829596063363163, "a0s": 0.0005436590706842545, "gms": 0.051976717951927945, "hmin": 0.00488024520875049, "mmin": 0.024338855308029886, "qinf": 5.795340579723236, "q10": 2.3663769919534694, "qg": 1.2376290094021916, "qd": 0.4032969286195285, "qa": 3.4123906974637475, "smax": 12.936425856666109, "sh": 9.039282419735736, "thinf": -47.321214965085595, "thi2": -11.488472132074708, "thi1": -40.2056980702163, "tha": -33.95095330231036, "vvs": 0.08465187335372848, "vvh": -60.15969616997436, "vhalfs": -29.355664047162417, "zetas": 10.791244127369858},
"mut2_1":{"Rd": 0.026488672266575884, "Rg": 0.014521555213498124, "Rb": 0.18467051140036536, "Ra": 0.201854755248321, "a0s": 0.0005126713396771124, "gms": 0.23362102543849317, "hmin": 0.002188524241568054, "mmin": 0.011465694968675786, "qinf": 5.452557549687859, "q10": 2.9951508615325375, "qg": 1.714590410731862, "qd": 0.9455820733103606, "qa": 3.6235354827461483, "smax": 2.51123314930111, "sh": 7.577321951780882, "thinf": -48.115191095696346, "thi2": -28.22215527442445, "thi1": -54.963680366153326, "tha": -38.945544100221525, "vvs": 1.6918621251596284, "vvh": -37.61837241234329, "vhalfs": -33.16787024353937, "zetas": 5.627916084890746},
"mut2_2":{"Rd": 0.024568997576556208, "Rg": 0.007317650985823302, "Rb": 0.15580034513261856, "Ra": 0.2074717052509235, "a0s": 0.00035255625529235926, "gms": 0.1882300126160065, "hmin": 0.013776819840234857, "mmin": 0.008760932186315322, "qinf": 5.817681179628916, "q10": 2.8054896844638995, "qg": 0.8199285552640376, "qd": 0.9513397437185004, "qa": 4.935184754699727, "smax": 7.80911971814305, "sh": 8.056820771894524, "thinf": -48.06270001511047, "thi2": -79.89537203368025, "thi1": -57.84717774377759, "tha": -36.36061882114468, "vvs": 1.2623175563216331, "vvh": -50.25675076922547, "vhalfs": -18.10018797925259, "zetas": 11.407939331697118},
"mut2_3":{"Rd": 0.024568997576556208, "Rg": 0.007317650985823302, "Rb": 0.15580034513261856, "Ra": 0.2074717052509235, "a0s": 0.00035255625529235926, "gms": 0.1882300126160065, "hmin": 0.013776819840234857, "mmin": 0.008760932186315322, "qinf": 5.817681179628916, "q10": 2.8054896844638995, "qg": 0.8199285552640376, "qd": 0.9513397437185004, "qa": 4.935184754699727, "smax": 7.80911971814305, "sh": 8.056820771894524, "thinf": -48.06270001511047, "thi2": -79.89537203368025, "thi1": -57.84717774377759, "tha": -36.36061882114468, "vvs": 1.2623175563216331, "vvh": -50.25675076922547, "vhalfs": -18.10018797925259, "zetas": 11.407939331697118},
"mut2_4":{"Rd": 0.02629027877428925, "Rg": 0.019132258151435464, "Rb": 0.061714464536991157, "Ra": 0.36313718930004546, "a0s": 0.0003192692544588723, "gms": 0.20788327805576493, "hmin": 0.01625247472025391, "mmin": 0.01605631251953759, "qinf": 5.695317706045491, "q10": 1.1092364311863656, "qg": 1.694992279113578, "qd": 0.9408262731784682, "qa": 5.472999418501854, "smax": 0.44726167195565725, "sh": 9.776252685086588, "thinf": -47.92956945335569, "thi2": -68.8383485029218, "thi1": -75.66873140994214, "tha": -24.154389927746223, "vvs": 1.0758438841035185, "vvh": -41.304704049603174, "vhalfs": -76.71650430791178, "zetas": 13.54065464579179},
"mut3_1":{"Rd": 0.021539333456066838, "Rg": 0.01938974273522918, "Rb": 0.13411093301106886, "Ra": 0.21575183395551836, "a0s": 0.0005529087074331134, "gms": 0.21270079991171037, "hmin": 0.010129317989188086, "mmin": 0.02140216916589976, "qinf": 5.747643991342539, "q10": 2.8578458238158424, "qg": 0.48203564020405343, "qd": 0.5211144608706483, "qa": 2.3712675160919576, "smax": 4.6892273830521995, "sh": 9.39478401562331, "thinf": -47.586106971554045, "thi2": -68.95868205440645, "thi1": -61.19254327074351, "tha": -35.45409605226765, "vvs": 1.1666354009954527, "vvh": -42.73456115494698, "vhalfs": -23.613298034423444, "zetas": 11.009713860557477},
"mut3_2":{"Rd": 0.025909960587237817, "Rg": 0.01301532636717773, "Rb": 0.06928306901315988, "Ra": 0.2400468270505505, "a0s": 0.0004051480377611907, "gms": 0.28985021747569156, "hmin": 0.0009298931489491125, "mmin": 0.0013780814794312262, "qinf": 5.758749071127669, "q10": 2.874963798192262, "qg": 0.0102193830352309, "qd": 0.9286240414247167, "qa": 3.9554726327850527, "smax": 10.162067476469025, "sh": 9.075896915201302, "thinf": -47.85910876010121, "thi2": -60.4155127487862, "thi1": -54.87233064733536, "tha": -33.67926392768192, "vvs": 1.105967394499335, "vvh": -52.19991810402488, "vhalfs": -35.597974686459224, "zetas": 14.843144548991685},
"mut3_3":{"Rd": 0.0271363014339307, "Rg": 0.010858549352013669, "Rb": 0.06585295850435718, "Ra": 0.2791135735002921, "a0s": 0.00032438477096202343, "gms": 0.21436332066470745, "hmin": 0.017513977142432767, "mmin": 0.02774675424687434, "qinf": 5.725803082061477, "q10": 1.0016551916921024, "qg": 0.19371017305461524, "qd": 0.9103875523095253, "qa": 6.99999781134728, "smax": 5.152711957150955, "sh": 7.276792427452112, "thinf": -48.03747927872592, "thi2": -65.24021114175424, "thi1": -58.77896600236174, "tha": -28.799011757174775, "vvs": 1.0063483984304196, "vvh": -45.20667242131125, "vhalfs": -46.481059113461704, "zetas": 6.278135363639492},
"mut3_4":{"Rd": 0.020578446277443114, "Rg": 0.01953710984717185, "Rb": 0.019233233329383644, "Ra": 0.30861755401365626, "a0s": 0.00035156711239535057, "gms": 0.054982483857439785, "hmin": 0.017063211046033012, "mmin": 0.020932334946455085, "qinf": 3.055252593235787, "q10": 1.6412667284258011, "qg": 1.4166523467160155, "qd": 0.6964383359839195, "qa": 6.9983155079130155, "smax": 10.319239709714752, "sh": 9.98385427598464, "thinf": -48.28672076529707, "thi2": -66.07796083260656, "thi1": -72.68847827161825, "tha": -28.96427387769314, "vvs": 1.1415149945100513, "vvh": -54.61209616180672, "vhalfs": -37.32750254108229, "zetas": 14.995060694851347},
"mut4_1":{"Rd": 0.026384861854339865, "Rg": 0.017216037795361894, "Rb": 0.12837300795550013, "Ra": 0.25353061607003063, "a0s": 4.2410228689384536e-05, "gms": 0.047598201971333035, "hmin": 2.5314573787947516e-05, "mmin": 0.011678299094720596, "qinf": 8.03840395078539, "q10": 1.188898296218245, "qg": 2.2313686936471093, "qd": 0.9923076877510596, "qa": 5.143730738736812, "smax": 0.4338639279533929, "sh": 8.302556502447649, "thinf": -61.98296501231657, "thi2": -79.46450173305057, "thi1": -58.46806411651639, "tha": -33.91750100895857, "vvs": 0.15841285406530475, "vvh": -50.028601292256695, "vhalfs": -58.097564586146376, "zetas": 9.72559058008965},
"mut4_2":{"Rd": 0.02399569184508087, "Rg": 0.01736234681500425, "Rb": 0.06796579214920581, "Ra": 0.24624446965793706, "a0s": 0.0003622291377675681, "gms": 0.22215913100281884, "hmin": 0.007684811966850041, "mmin": 0.011263354311723246, "qinf": 6.500767509176027, "q10": 1.9506685569649513, "qg": 0.902226460815369, "qd": 0.9653994204249137, "qa": 4.294582223935696, "smax": 10.993411752090926, "sh": 7.050855813669112, "thinf": -53.47882254794794, "thi2": -78.29383036298663, "thi1": -60.61175386462758, "tha": -32.305266703802594, "vvs": 1.4853241490501752, "vvh": -46.546940967760726, "vhalfs": -12.66123147522818, "zetas": 11.59991821878199},
"mut4_3":{"Rd": 0.025519311583448303, "Rg": 0.01806790427865722, "Rb": 0.14536347409240222, "Ra": 0.2502352871993136, "a0s": 0.0004482266716084482, "gms": 0.25476569172309727, "hmin": 0.007009950451522886, "mmin": 0.012003514193781189, "qinf": 4.574920476393687, "q10": 1.1476457207741035, "qg": 0.8184153828395149, "qd": 0.8019833921128907, "qa": 4.2160541571770445, "smax": 9.877655307428789, "sh": 8.832427988260633, "thinf": -41.2194849673826, "thi2": -74.26014478651132, "thi1": -57.62507940240592, "tha": -34.484266795766665, "vvs": 0.03466597648718478, "vvh": -57.04382755988163, "vhalfs": -32.696746528263084, "zetas": 7.87226495513529},
"mut4_4":{"Rd": 0.025052849459063147, "Rg": 0.0199945959122063, "Rb": 0.1739638338964311, "Ra": 0.26626158699466906, "a0s": 0.0003502130628134103, "gms": 0.12295077631157378, "hmin": 0.015137265883554222, "mmin": 0.02749013485793254, "qinf": 3.8432845245511356, "q10": 1.607941869392826, "qg": 0.03926409957568844, "qd": 0.7413232627776244, "qa": 5.306667666039221, "smax": 5.577547491712884, "sh": 7.412961945319315, "thinf": -35.44310538816553, "thi2": -67.9475516783775, "thi1": -55.53112330548022, "tha": -32.14875825683306, "vvs": 0.5246979360028227, "vvh": -59.26845090365563, "vhalfs": -48.74952890850776, "zetas": 12.651993154900477},
"mut5_1":{"Rd": 0.02701119998697379, "Rg": 0.007554313646539795, "Rb": 0.08216524515733808, "Ra": 0.2643532759351036, "a0s": 0.0005791118316328197, "gms": 0.09569139098075205, "hmin": 0.017441209515602008, "mmin": 0.004079127084017231, "qinf": 5.982753017834614, "q10": 2.3603433059614267, "qg": 0.14060902415157334, "qd": 0.46055169561574194, "qa": 5.037269076531583, "smax": 2.3498017637203565, "sh": 8.238211223086939, "thinf": -48.555764886778405, "thi2": -63.39786268469176, "thi1": -53.127136979567126, "tha": -31.5348318373408, "vvs": 1.6060786711953108, "vvh": -46.2496450815056, "vhalfs": -24.38275864219653, "zetas": 12.061354057836986},
"mut5_2":{"Rd": 0.024099283532945864, "Rg": 0.017583697354344716, "Rb": 0.10373183010152592, "Ra": 0.22652447463153436, "a0s": 0.0004990826734574562, "gms": 0.11823773635172939, "hmin": 0.01390743040880614, "mmin": 0.0036606094304718374, "qinf": 5.835606664662725, "q10": 2.2353734180224523, "qg": 1.0366340336768565, "qd": 0.5618624753047958, "qa": 4.691898873772695, "smax": 2.1802923692990097, "sh": 8.657605677232198, "thinf": -47.62991303180279, "thi2": -78.49335010452293, "thi1": -59.368805568553846, "tha": -34.22146065050052, "vvs": 0.017447769498914023, "vvh": -48.75974258317825, "vhalfs": -27.441696653845405, "zetas": 13.53270255526033},
"mut5_3":{"Rd": 0.024002463356996972, "Rg": 0.01899583310300501, "Rb": 0.11558682832893928, "Ra": 0.24594742113961007, "a0s": 0.0003980998585412338, "gms": 0.07385059647142797, "hmin": 0.002370317143968269, "mmin": 0.00038581081425028904, "qinf": 6.088769354858897, "q10": 2.3347981826817135, "qg": 1.5901112115667582, "qd": 0.753841504155426, "qa": 4.7160969489808435, "smax": 4.807659128552935, "sh": 8.853423907562162, "thinf": -47.72412825560719, "thi2": -55.09737320786358, "thi1": -59.89350855435276, "tha": -34.4392676782676, "vvs": 0.10315039523947883, "vvh": -53.8217560426071, "vhalfs": -40.48652139039861, "zetas": 11.594601823841135},
"mut5_4":{"Rd": 0.024720112917881055, "Rg": 0.018541343511408848, "Rb": 0.11259456304121376, "Ra": 0.24712131121970332, "a0s": 0.0004972541639862278, "gms": 0.14061659320270067, "hmin": 0.015502759721939445, "mmin": 0.0026758513976433617, "qinf": 6.203090285648935, "q10": 1.8105567164212135, "qg": 0.0026131733274903646, "qd": 0.6180282819328444, "qa": 5.116746587458819, "smax": 7.324766525525432, "sh": 8.884798383997602, "thinf": -48.126302165543045, "thi2": -23.46761130680343, "thi1": -57.36559608546103, "tha": -33.76958313917315, "vvs": 1.222203774598586, "vvh": -32.45341504947651, "vhalfs": -30.027983577593623, "zetas": 7.295584046622534},
"mut10_1":{"Rd": 0.027395728264448305, "Rg": 0.019480744967267646, "Rb": 0.13764175491228756, "Ra": 0.3249271716724938, "a0s": 0.0003108982883780263, "gms": 0.07492898371136576, "hmin": 0.018575871305948823, "mmin": 0.018826485307131623, "qinf": 5.694358259122065, "q10": 2.7529370746620305, "qg": 0.36482273291978423, "qd": 0.9929256455655058, "qa": 4.212896480253771, "smax": 1.0915477358638386, "sh": 8.839404835874905, "thinf": -48.00704037156025, "thi2": -50.59206400067486, "thi1": -73.8256011660641, "tha": -35.31387920279738, "vvs": 1.0447778994280894, "vvh": -60.42500565507859, "vhalfs": -20.50066108952194, "zetas": 13.413655031086758},
"mut10_2":{"Rd": 0.025427888508545497, "Rg": 0.01867129230675479, "Rb": 0.08067641172638762, "Ra": 0.2394687009764217, "a0s": 0.00034200332989650027, "gms": 0.10548351315764355, "hmin": 0.001721878528020299, "mmin": 0.015943378274537012, "qinf": 5.952385140097297, "q10": 1.2298407393879724, "qg": 1.6926240924646268, "qd": 0.7602015434301642, "qa": 4.746543975487382, "smax": 4.428924987924885, "sh": 7.689399939938984, "thinf": -48.02516881685639, "thi2": -68.54837800734377, "thi1": -54.39555027048551, "tha": -32.09916894494031, "vvs": 0.012839785406228824, "vvh": -55.176351528001476, "vhalfs": -34.19156599964327, "zetas": 8.98793974393631},
"mut10_3":{"Rd": 0.013908932581666932, "Rg": 0.014575092951801703, "Rb": 0.18760211728918308, "Ra": 0.12072519564140358, "a0s": 0.0004985472674731082, "gms": 0.010143402352321734, "hmin": 6.560553546681753e-05, "mmin": 0.027647039892021535, "qinf": 6.117383062665207, "q10": 1.9189604790205586, "qg": 1.0310705933915763, "qd": 0.2766710550665108, "qa": 6.75363247734855, "smax": 3.956389362212434, "sh": 8.672991520900368, "thinf": -47.21893265643665, "thi2": -60.751781707044586, "thi1": -55.786034262344415, "tha": -38.8956417666429, "vvs": 2.5190085323411244, "vvh": -46.209063527481625, "vhalfs": -26.147846554308405, "zetas": 11.549872109450808},
"mut10_4":{"Rd": 0.018479249784270027, "Rg": 0.01616892761262375, "Rb": 0.05286426454631773, "Ra": 0.12985817805068953, "a0s": 2.8288493393966482e-05, "gms": 0.10502212608962722, "hmin": 0.008599567520185323, "mmin": 0.008917358474255515, "qinf": 6.1900805899006235, "q10": 2.1281611120423802, "qg": 0.46434971436387396, "qd": 0.3032625735170217, "qa": 6.25751655147087, "smax": 3.0514982093913803, "sh": 7.898262215221069, "thinf": -47.70290807827395, "thi2": -28.118306998400087, "thi1": -33.89828989262652, "tha": -28.729965547198262, "vvs": 1.3392504515168708, "vvh": -52.41899200534546, "vhalfs": -11.055561422439292, "zetas": 14.790369980888514},
"mut11_1":{"Rd": 0.021929866885543, "Rg": 0.01772208016037675, "Rb": 0.10172290726180878, "Ra": 0.24440983158445595, "a0s": 0.0004935602113180277, "gms": 0.1381127098924386, "hmin": 0.0067952192150873125, "mmin": 0.012323186826064238, "qinf": 5.429528389097359, "q10": 2.2392618221594183, "qg": 0.4685311154864299, "qd": 0.6365899397217457, "qa": 4.100733825897971, "smax": 13.9077232347004, "sh": 8.408165494867305, "thinf": -47.75777305201812, "thi2": -77.96373863535196, "thi1": -66.99940757785221, "tha": -34.4805504066182, "vvs": 2.0108543610382807, "vvh": -48.34012571001951, "vhalfs": -28.974566351542382, "zetas": 8.699065029839916},
"mut11_2":{"Rd": 0.023399942200925325, "Rg": 0.019965436157259105, "Rb": 0.07540978457250698, "Ra": 0.2425151396623956, "a0s": 0.0004582582633983299, "gms": 0.1481485549246561, "hmin": 0.014242232545166386, "mmin": 0.016294071300598584, "qinf": 5.809590563587539, "q10": 2.3186898190865453, "qg": 2.590203157614032, "qd": 0.46913038818651925, "qa": 4.4175193206822465, "smax": 5.138986188281341, "sh": 8.617075165527536, "thinf": -47.74688173180442, "thi2": -78.17190276861996, "thi1": -61.2842877147508, "tha": -33.59370566796033, "vvs": 1.0459406825848059, "vvh": -56.42105481340581, "vhalfs": -29.60456097617442, "zetas": 8.427767048585112},
"mut11_3":{"Rd": 0.02564061284443833, "Rg": 0.016454713299112786, "Rb": 0.10055904165597555, "Ra": 0.24116104446108555, "a0s": 0.0005665182625568133, "gms": 0.2325358602970435, "hmin": 0.012157008344442369, "mmin": 0.005806104547125069, "qinf": 5.901283391483913, "q10": 2.524586640609418, "qg": 0.8736025508090265, "qd": 0.8611346672394538, "qa": 4.757270560835982, "smax": 11.506898111190113, "sh": 8.798872576220642, "thinf": -48.100165815706426, "thi2": -70.04390653046077, "thi1": -79.9757965536142, "tha": -34.314579389963136, "vvs": 0.24021797968728012, "vvh": -45.9545692482469, "vhalfs": -49.860386242027374, "zetas": 13.7529382260335},
"mut11_4":{"Rd": 0.02369089815905383, "Rg": 0.008411557890444519, "Rb": 0.0487880328533895, "Ra": 0.17157260073059677, "a0s": 0.00025582958331112407, "gms": 0.12885704931583242, "hmin": 0.009303535999447674, "mmin": 0.026948335934518956, "qinf": 6.133979134314556, "q10": 2.4395947125438777, "qg": 0.10347113488469517, "qd": 0.7004724820031882, "qa": 3.9529743529841057, "smax": 9.393026842614292, "sh": 7.737377293674833, "thinf": -47.68032583551547, "thi2": -33.72623707497113, "thi1": -60.263660406796404, "tha": -34.243539777964415, "vvs": 1.9758347847089923, "vvh": -55.213940227332245, "vhalfs": -10.582542092497823, "zetas": 10.751467859832209},
"mut12_1":{"Rd": 0.0269169700230419, "Rg": 0.005347068230662407, "Rb": 0.09920725283147158, "Ra": 0.26109164294225423, "a0s": 0.00037581955408674025, "gms": 0.24325485083330284, "hmin": 0.0021755391192732594, "mmin": 0.01080660170954422, "qinf": 6.040884817154375, "q10": 1.4150507250158433, "qg": 1.138025041093626, "qd": 0.8989630852152845, "qa": 4.889924968564757, "smax": 1.9341001262945832, "sh": 6.38171407336664, "thinf": -47.99943274074794, "thi2": -74.66381828125607, "thi1": -55.98612683431803, "tha": -30.91762067327644, "vvs": 1.0604315655779213, "vvh": -59.435470320512486, "vhalfs": -41.7519335575422, "zetas": 11.589784187186154},
"mut12_2":{"Rd": 0.024960360998484764, "Rg": 0.01459806798243318, "Rb": 0.0965308116834002, "Ra": 0.2476236762645026, "a0s": 0.0003970265495369906, "gms": 0.26908192205699105, "hmin": 0.007002949283398527, "mmin": 0.0020126504372082544, "qinf": 5.86212977573515, "q10": 1.7693069963235182, "qg": 0.42566376175974086, "qd": 0.9348269309637147, "qa": 4.706547613275087, "smax": 0.3616111229538904, "sh": 6.354998108202179, "thinf": -47.80635799237096, "thi2": -75.10834997946692, "thi1": -58.49643913016675, "tha": -31.395524686881505, "vvs": 0.10626923677921263, "vvh": -56.40100376489494, "vhalfs": -35.1625290212924, "zetas": 4.551755258930188},
"mut12_3":{"Rd": 0.025865328977864616, "Rg": 0.01717656999787636, "Rb": 0.09138198458434318, "Ra": 0.24226850051330223, "a0s": 7.447219563913707e-06, "gms": 0.2509840296668697, "hmin": 0.014895887171197417, "mmin": 0.013019199823609646, "qinf": 5.9415490073459605, "q10": 2.9078178415770912, "qg": 1.5001201181216812, "qd": 0.8732070577446075, "qa": 4.69430490421596, "smax": 10.588052073819421, "sh": 6.996482926016626, "thinf": -48.045720370651125, "thi2": -69.19614472115914, "thi1": -55.33440183206611, "tha": -31.716011904495094, "vvs": 0.10445927859958029, "vvh": -51.24507714355363, "vhalfs": -11.81638421851683, "zetas": 6.441705936359468},
"mut12_4":{"Rd": 0.026341829109144867, "Rg": 0.01595747635837312, "Rb": 0.11385415617192195, "Ra": 0.25294958624382163, "a0s": 0.0003569150129602803, "gms": 0.12283361477301487, "hmin": 0.01203624127992991, "mmin": 0.027434699923145837, "qinf": 6.02052583745145, "q10": 2.224591292047369, "qg": 1.7257806606927213, "qd": 0.793295971364335, "qa": 5.364623777926906, "smax": 2.684965115586759, "sh": 7.787220023721729, "thinf": -47.97568300997233, "thi2": -71.68791038210352, "thi1": -56.632696149747105, "tha": -32.8884899922085, "vvs": 0.13072318176479514, "vvh": -44.478187791313346, "vhalfs": -14.23682084873365, "zetas": 13.207234994555186},
"mut13_1":{"Rd": 0.029974392171229224, "Rg": 0.01723878208886209, "Rb": 0.19598636322137022, "Ra": 0.39995837227856523, "a0s": 0.00016631094744527802, "gms": 0.0413964412861661, "hmin": 0.007264199980766417, "mmin": 0.0074126523834307165, "qinf": 3.66417913492673, "q10": 2.9721532173384038, "qg": 1.7348053244590236, "qd": 0.22197117406537867, "qa": 3.021129876809143, "smax": 1.9299089755085368, "sh": 9.880963733806805, "thinf": -52.80928722848205, "thi2": -10.018936084937572, "thi1": -79.84874699913891, "tha": -48.88815778993708, "vvs": 2.9983238755993975, "vvh": -58.38200721906789, "vhalfs": -69.8447949466605, "zetas": 8.049515470375628},
"mut13_2":{"Rd": 0.028289119185471303, "Rg": 0.016854722880919853, "Rb": 0.19294197772314586, "Ra": 0.39944770850287936, "a0s": 0.00017468173639105538, "gms": 0.11056415641757504, "hmin": 0.0019085075558057587, "mmin": 0.01525467542228769, "qinf": 5.71927987888793, "q10": 2.797446091847996, "qg": 1.4309488443931455, "qd": 0.9681764462009756, "qa": 4.956574665309508, "smax": 5.246893417369555, "sh": 8.143855692622687, "thinf": -46.6145097302023, "thi2": -77.33304511993045, "thi1": -79.89660566761904, "tha": -33.38385015208642, "vvs": 0.2432618106950166, "vvh": -56.229613918181315, "vhalfs": -64.29146078036919, "zetas": 13.295933297399511},
"mut13_3":{"Rd": 0.014267402851293746, "Rg": 0.015850217229197324, "Rb": 0.14962839423301066, "Ra": 0.06023384478710728, "a0s": 0.00025114869308605234, "gms": 0.1871481102391445, "hmin": 0.010323488536806008, "mmin": 0.015644559361666963, "qinf": 4.5120938008566025, "q10": 2.487611415550795, "qg": 0.8355645676420531, "qd": 0.827198302166888, "qa": 5.381783153855559, "smax": 11.366921127643964, "sh": 8.071359940225756, "thinf": -43.611389014509406, "thi2": -69.33834991280328, "thi1": -72.111139316991, "tha": -43.43512375742244, "vvs": 1.6744532804885472, "vvh": -43.817468581045475, "vhalfs": -20.75694219557058, "zetas": 14.574838796880186},
"mut13_4":{"Rd": 0.012988426392609989, "Rg": 0.017786306699059905, "Rb": 0.1384695592633962, "Ra": 0.018872850696954862, "a0s": 0.0005307929617695427, "gms": 0.05363336599172791, "hmin": 0.011734614458042043, "mmin": 0.0034437471574469843, "qinf": 7.1934539338187395, "q10": 1.8750070063126019, "qg": 1.2683661982186067, "qd": 0.9587028374398872, "qa": 6.3557624513757895, "smax": 9.27916730538191, "sh": 9.720408518152473, "thinf": -53.88626660536972, "thi2": -78.40736012087147, "thi1": -76.96809140338001, "tha": -50.38737888206187, "vvs": 1.1788504917702238, "vvh": -56.406817229632715, "vhalfs": -46.536377410720625, "zetas": 14.740130258226197},
}

smuts_14={
"mut1_1":{"Rd": 0.02735697744172416, "Rg": 0.015153179764486211, "Rb": 0.06839644002628642, "Ra": 0.06545839275251729, "a0s": 3.891225904362574e-05, "gms": 0.15058560674306543, "hmin": 0.011630227927729742, "mmin": 0.023810464774892803, "qinf": 4.953081496370763, "q10": 2.074518025347742, "qg": 0.7502977896607076, "qd": 0.6883898348664786, "qa": 2.7160304672592126, "smax": 11.001447404597304, "sh": 5.318004929952289, "thinf": -46.65398181437308, "thi2": -77.38739373440524, "thi1": -58.672057291319454, "tha": -36.45013125792124, "vvs": 0.647108419223072, "vvh": -52.38278563203291, "vhalfs": -19.732784818992535, "zetas": 7.744543181377883},
"mut1_4":{"Rd": 0.029910943918873223, "Rg": 0.016428398412077293, "Rb": 0.16173505702988325, "Ra": 0.24829596063363163, "a0s": 0.0005436590706842545, "gms": 0.051976717951927945, "hmin": 0.00488024520875049, "mmin": 0.024338855308029886, "qinf": 5.795340579723236, "q10": 2.3663769919534694, "qg": 1.2376290094021916, "qd": 0.4032969286195285, "qa": 3.4123906974637475, "smax": 12.936425856666109, "sh": 9.039282419735736, "thinf": -47.321214965085595, "thi2": -11.488472132074708, "thi1": -40.2056980702163, "tha": -33.95095330231036, "vvs": 0.08465187335372848, "vvh": -60.15969616997436, "vhalfs": -29.355664047162417, "zetas": 10.791244127369858},
"mut2_1":{"Rd": 0.026488672266575884, "Rg": 0.014521555213498124, "Rb": 0.18467051140036536, "Ra": 0.201854755248321, "a0s": 0.0005126713396771124, "gms": 0.23362102543849317, "hmin": 0.002188524241568054, "mmin": 0.011465694968675786, "qinf": 5.452557549687859, "q10": 2.9951508615325375, "qg": 1.714590410731862, "qd": 0.9455820733103606, "qa": 3.6235354827461483, "smax": 2.51123314930111, "sh": 7.577321951780882, "thinf": -48.115191095696346, "thi2": -28.22215527442445, "thi1": -54.963680366153326, "tha": -38.945544100221525, "vvs": 1.6918621251596284, "vvh": -37.61837241234329, "vhalfs": -33.16787024353937, "zetas": 5.627916084890746},
"mut2_4":{"Rd": 0.02629027877428925, "Rg": 0.019132258151435464, "Rb": 0.061714464536991157, "Ra": 0.36313718930004546, "a0s": 0.0003192692544588723, "gms": 0.20788327805576493, "hmin": 0.01625247472025391, "mmin": 0.01605631251953759, "qinf": 5.695317706045491, "q10": 1.1092364311863656, "qg": 1.694992279113578, "qd": 0.9408262731784682, "qa": 5.472999418501854, "smax": 0.44726167195565725, "sh": 9.776252685086588, "thinf": -47.92956945335569, "thi2": -68.8383485029218, "thi1": -75.66873140994214, "tha": -24.154389927746223, "vvs": 1.0758438841035185, "vvh": -41.304704049603174, "vhalfs": -76.71650430791178, "zetas": 13.54065464579179},
"mut3_1":{"Rd": 0.021539333456066838, "Rg": 0.01938974273522918, "Rb": 0.13411093301106886, "Ra": 0.21575183395551836, "a0s": 0.0005529087074331134, "gms": 0.21270079991171037, "hmin": 0.010129317989188086, "mmin": 0.02140216916589976, "qinf": 5.747643991342539, "q10": 2.8578458238158424, "qg": 0.48203564020405343, "qd": 0.5211144608706483, "qa": 2.3712675160919576, "smax": 4.6892273830521995, "sh": 9.39478401562331, "thinf": -47.586106971554045, "thi2": -68.95868205440645, "thi1": -61.19254327074351, "tha": -35.45409605226765, "vvs": 1.1666354009954527, "vvh": -42.73456115494698, "vhalfs": -23.613298034423444, "zetas": 11.009713860557477},
"mut3_4":{"Rd": 0.020578446277443114, "Rg": 0.01953710984717185, "Rb": 0.019233233329383644, "Ra": 0.30861755401365626, "a0s": 0.00035156711239535057, "gms": 0.054982483857439785, "hmin": 0.017063211046033012, "mmin": 0.020932334946455085, "qinf": 3.055252593235787, "q10": 1.6412667284258011, "qg": 1.4166523467160155, "qd": 0.6964383359839195, "qa": 6.9983155079130155, "smax": 10.319239709714752, "sh": 9.98385427598464, "thinf": -48.28672076529707, "thi2": -66.07796083260656, "thi1": -72.68847827161825, "tha": -28.96427387769314, "vvs": 1.1415149945100513, "vvh": -54.61209616180672, "vhalfs": -37.32750254108229, "zetas": 14.995060694851347},
"mut4_1":{"Rd": 0.026384861854339865, "Rg": 0.017216037795361894, "Rb": 0.12837300795550013, "Ra": 0.25353061607003063, "a0s": 4.2410228689384536e-05, "gms": 0.047598201971333035, "hmin": 2.5314573787947516e-05, "mmin": 0.011678299094720596, "qinf": 8.03840395078539, "q10": 1.188898296218245, "qg": 2.2313686936471093, "qd": 0.9923076877510596, "qa": 5.143730738736812, "smax": 0.4338639279533929, "sh": 8.302556502447649, "thinf": -61.98296501231657, "thi2": -79.46450173305057, "thi1": -58.46806411651639, "tha": -33.91750100895857, "vvs": 0.15841285406530475, "vvh": -50.028601292256695, "vhalfs": -58.097564586146376, "zetas": 9.72559058008965},
"mut4_4":{"Rd": 0.025052849459063147, "Rg": 0.0199945959122063, "Rb": 0.1739638338964311, "Ra": 0.26626158699466906, "a0s": 0.0003502130628134103, "gms": 0.12295077631157378, "hmin": 0.015137265883554222, "mmin": 0.02749013485793254, "qinf": 3.8432845245511356, "q10": 1.607941869392826, "qg": 0.03926409957568844, "qd": 0.7413232627776244, "qa": 5.306667666039221, "smax": 5.577547491712884, "sh": 7.412961945319315, "thinf": -35.44310538816553, "thi2": -67.9475516783775, "thi1": -55.53112330548022, "tha": -32.14875825683306, "vvs": 0.5246979360028227, "vvh": -59.26845090365563, "vhalfs": -48.74952890850776, "zetas": 12.651993154900477},
"mut5_1":{"Rd": 0.02701119998697379, "Rg": 0.007554313646539795, "Rb": 0.08216524515733808, "Ra": 0.2643532759351036, "a0s": 0.0005791118316328197, "gms": 0.09569139098075205, "hmin": 0.017441209515602008, "mmin": 0.004079127084017231, "qinf": 5.982753017834614, "q10": 2.3603433059614267, "qg": 0.14060902415157334, "qd": 0.46055169561574194, "qa": 5.037269076531583, "smax": 2.3498017637203565, "sh": 8.238211223086939, "thinf": -48.555764886778405, "thi2": -63.39786268469176, "thi1": -53.127136979567126, "tha": -31.5348318373408, "vvs": 1.6060786711953108, "vvh": -46.2496450815056, "vhalfs": -24.38275864219653, "zetas": 12.061354057836986},
"mut5_4":{"Rd": 0.024720112917881055, "Rg": 0.018541343511408848, "Rb": 0.11259456304121376, "Ra": 0.24712131121970332, "a0s": 0.0004972541639862278, "gms": 0.14061659320270067, "hmin": 0.015502759721939445, "mmin": 0.0026758513976433617, "qinf": 6.203090285648935, "q10": 1.8105567164212135, "qg": 0.0026131733274903646, "qd": 0.6180282819328444, "qa": 5.116746587458819, "smax": 7.324766525525432, "sh": 8.884798383997602, "thinf": -48.126302165543045, "thi2": -23.46761130680343, "thi1": -57.36559608546103, "tha": -33.76958313917315, "vvs": 1.222203774598586, "vvh": -32.45341504947651, "vhalfs": -30.027983577593623, "zetas": 7.295584046622534},
"mut10_1":{"Rd": 0.027395728264448305, "Rg": 0.019480744967267646, "Rb": 0.13764175491228756, "Ra": 0.3249271716724938, "a0s": 0.0003108982883780263, "gms": 0.07492898371136576, "hmin": 0.018575871305948823, "mmin": 0.018826485307131623, "qinf": 5.694358259122065, "q10": 2.7529370746620305, "qg": 0.36482273291978423, "qd": 0.9929256455655058, "qa": 4.212896480253771, "smax": 1.0915477358638386, "sh": 8.839404835874905, "thinf": -48.00704037156025, "thi2": -50.59206400067486, "thi1": -73.8256011660641, "tha": -35.31387920279738, "vvs": 1.0447778994280894, "vvh": -60.42500565507859, "vhalfs": -20.50066108952194, "zetas": 13.413655031086758},
"mut10_4":{"Rd": 0.018479249784270027, "Rg": 0.01616892761262375, "Rb": 0.05286426454631773, "Ra": 0.12985817805068953, "a0s": 2.8288493393966482e-05, "gms": 0.10502212608962722, "hmin": 0.008599567520185323, "mmin": 0.008917358474255515, "qinf": 6.1900805899006235, "q10": 2.1281611120423802, "qg": 0.46434971436387396, "qd": 0.3032625735170217, "qa": 6.25751655147087, "smax": 3.0514982093913803, "sh": 7.898262215221069, "thinf": -47.70290807827395, "thi2": -28.118306998400087, "thi1": -33.89828989262652, "tha": -28.729965547198262, "vvs": 1.3392504515168708, "vvh": -52.41899200534546, "vhalfs": -11.055561422439292, "zetas": 14.790369980888514},
"mut11_1":{"Rd": 0.021929866885543, "Rg": 0.01772208016037675, "Rb": 0.10172290726180878, "Ra": 0.24440983158445595, "a0s": 0.0004935602113180277, "gms": 0.1381127098924386, "hmin": 0.0067952192150873125, "mmin": 0.012323186826064238, "qinf": 5.429528389097359, "q10": 2.2392618221594183, "qg": 0.4685311154864299, "qd": 0.6365899397217457, "qa": 4.100733825897971, "smax": 13.9077232347004, "sh": 8.408165494867305, "thinf": -47.75777305201812, "thi2": -77.96373863535196, "thi1": -66.99940757785221, "tha": -34.4805504066182, "vvs": 2.0108543610382807, "vvh": -48.34012571001951, "vhalfs": -28.974566351542382, "zetas": 8.699065029839916},
"mut11_4":{"Rd": 0.02369089815905383, "Rg": 0.008411557890444519, "Rb": 0.0487880328533895, "Ra": 0.17157260073059677, "a0s": 0.00025582958331112407, "gms": 0.12885704931583242, "hmin": 0.009303535999447674, "mmin": 0.026948335934518956, "qinf": 6.133979134314556, "q10": 2.4395947125438777, "qg": 0.10347113488469517, "qd": 0.7004724820031882, "qa": 3.9529743529841057, "smax": 9.393026842614292, "sh": 7.737377293674833, "thinf": -47.68032583551547, "thi2": -33.72623707497113, "thi1": -60.263660406796404, "tha": -34.243539777964415, "vvs": 1.9758347847089923, "vvh": -55.213940227332245, "vhalfs": -10.582542092497823, "zetas": 10.751467859832209},
"mut12_1":{"Rd": 0.0269169700230419, "Rg": 0.005347068230662407, "Rb": 0.09920725283147158, "Ra": 0.26109164294225423, "a0s": 0.00037581955408674025, "gms": 0.24325485083330284, "hmin": 0.0021755391192732594, "mmin": 0.01080660170954422, "qinf": 6.040884817154375, "q10": 1.4150507250158433, "qg": 1.138025041093626, "qd": 0.8989630852152845, "qa": 4.889924968564757, "smax": 1.9341001262945832, "sh": 6.38171407336664, "thinf": -47.99943274074794, "thi2": -74.66381828125607, "thi1": -55.98612683431803, "tha": -30.91762067327644, "vvs": 1.0604315655779213, "vvh": -59.435470320512486, "vhalfs": -41.7519335575422, "zetas": 11.589784187186154},
"mut12_4":{"Rd": 0.026341829109144867, "Rg": 0.01595747635837312, "Rb": 0.11385415617192195, "Ra": 0.25294958624382163, "a0s": 0.0003569150129602803, "gms": 0.12283361477301487, "hmin": 0.01203624127992991, "mmin": 0.027434699923145837, "qinf": 6.02052583745145, "q10": 2.224591292047369, "qg": 1.7257806606927213, "qd": 0.793295971364335, "qa": 5.364623777926906, "smax": 2.684965115586759, "sh": 7.787220023721729, "thinf": -47.97568300997233, "thi2": -71.68791038210352, "thi1": -56.632696149747105, "tha": -32.8884899922085, "vvs": 0.13072318176479514, "vvh": -44.478187791313346, "vhalfs": -14.23682084873365, "zetas": 13.207234994555186},
"mut13_1":{"Rd": 0.029974392171229224, "Rg": 0.01723878208886209, "Rb": 0.19598636322137022, "Ra": 0.39995837227856523, "a0s": 0.00016631094744527802, "gms": 0.0413964412861661, "hmin": 0.007264199980766417, "mmin": 0.0074126523834307165, "qinf": 3.66417913492673, "q10": 2.9721532173384038, "qg": 1.7348053244590236, "qd": 0.22197117406537867, "qa": 3.021129876809143, "smax": 1.9299089755085368, "sh": 9.880963733806805, "thinf": -52.80928722848205, "thi2": -10.018936084937572, "thi1": -79.84874699913891, "tha": -48.88815778993708, "vvs": 2.9983238755993975, "vvh": -58.38200721906789, "vhalfs": -69.8447949466605, "zetas": 8.049515470375628},
"mut13_4":{"Rd": 0.012988426392609989, "Rg": 0.017786306699059905, "Rb": 0.1384695592633962, "Ra": 0.018872850696954862, "a0s": 0.0005307929617695427, "gms": 0.05363336599172791, "hmin": 0.011734614458042043, "mmin": 0.0034437471574469843, "qinf": 7.1934539338187395, "q10": 1.8750070063126019, "qg": 1.2683661982186067, "qd": 0.9587028374398872, "qa": 6.3557624513757895, "smax": 9.27916730538191, "sh": 9.720408518152473, "thinf": -53.88626660536972, "thi2": -78.40736012087147, "thi1": -76.96809140338001, "tha": -50.38737888206187, "vvs": 1.1788504917702238, "vvh": -56.406817229632715, "vhalfs": -46.536377410720625, "zetas": 14.740130258226197},
}



allmutsefel = pd.DataFrame()

for config_name, config in config_dict3.items():
  for a2 in [0.99,0.9,0.8,0.75,0.25]:
    ar2mut ={"Rd": 0.023204006298533603, "Rg": 0.015604498120126004, "Rb": 0.0925081211054913, "Ra": 0.23933332265451177, "a0s": 0.0005226303768198727, "gms": 0.14418575154491814, "hmin": 0.008449935591049326, "mmin": 0.01193016441163175, "qinf": 5.7593653647578105, "q10": 2.1532859986639186, "qg": 1.2968193480468215, "qd": 0.661199851452832, "qa": 5.41, "smax": 3.5557932199839737, "sh": 8.358558450280716, "thinf": -47.8194205612529, "thi2": -79.6556083820085, "thi1": -62.40165437813537, "tha": -33.850064879126805, "vvs": 1.4255479951467982, "vvh": -55.33213046147061, "vhalfs": -40.89976480829731, "zetas": 13.403615755952343,"ar2": a2
    }

    path = f'23-PaperPlots/5-ar2-{a2}_debug_062025'

    ## WT ##
    simwt = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08*0.6,
                                  nav12=1.1*1.1,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                                  ais_ca = 43*0.5,ais_Kca = 0.25,
                                  soma_na16=0.8,soma_na12=2.56,node_na = 1,
                                  dend_nav12=1,
                                  na12name = 'na12annaTFHH',mut_name = 'na12annaTFHH',na12mechs = ['na12','na12mut'],
                                  na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                                  plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
    wt_Vm,_,wt_t,_ = simwt.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
    # wt_fi=simwt.plot_fi_curve_2line(wt_data=None,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'WT_FI', epochlabel='500ms')
    # simwt.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx=f'WT-')
    # features = ef.get_features(sim=simwt, prefix=f'{root_path_out}/{path}/wt', mut_name=f'{root_path_out}/{path}/WT')
    # allmutsefel = allmutsefel.append(features, ignore_index=True)

    # fig_volts,axs = plt.subplots(2,figsize=(cm_to_in(8),cm_to_in(15)))
    # simwt.plot_stim(axs = axs[0],stim_amp = 0.5,dt=0.005,stim_dur = 200, clr='cadetblue')
    # plot_dvdt_from_volts(simwt.volt_soma, simwt.dt, axs[1],clr='cadetblue')
    # fig_volts.savefig(f'{simwt.plot_folder}/WT_200swp_stim0.5.pdf') #Change output file path here

    modify_dict_file(filenamemut,ar2mut)
  ## ar2 debug ##
    simar2 = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08*0.6,
                                  nav12=1.1*1.1,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                                  ais_ca = 43*0.5,ais_Kca = 0.25,
                                  soma_na16=0.8,soma_na12=2.56,node_na = 1,
                                  dend_nav12=1,
                                  na12name = 'na12annaTFHH2mut',mut_name = 'na12annaTFHH2mut',na12mechs = ['na12','na12mut'],
                                  na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                                  plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
    ar2_Vm,_,ar2_t,_ = simar2.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
    # wt_fi=simar2.plot_fi_curve_2line(wt_data=None,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'WT_FI', epochlabel='500ms')
    simar2.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx=f'WT-')
    simar2.wtvsmut_stim_dvdt(wt_Vm=wt_Vm,wt_t=wt_t,het_Vm=None,het_t=None,sim_config=config,vs_amp=[0.5],stim_dur=500, fnpre=f'ar2-{a2}')

  
  # fig_volts,axs = plt.subplots(2,figsize=(cm_to_in(8),cm_to_in(15)))
  # simar2.plot_stim(axs = axs[0],stim_amp = 0.5,dt=0.005,stim_dur = 200, clr='cadetblue')
  # plot_dvdt_from_volts(simar2.volt_soma, simar2.dt, axs[1],clr='cadetblue')
  # fig_volts.savefig(f'{simar2.plot_folder}/WT_ar2-0.pdf') #Change output file path here



input("press enter")
'''  
## Heterozygous ##
  simhet = tf.Na12Model_TF(ais_nav12_fac=5.76*0.5,ais_nav16_fac=1.08*0.6,
                                nav12=1.1*1.1*0.5,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                                ais_ca = 43*0.5,ais_Kca = 0.25,
                                soma_na16=0.8,soma_na12=2.56*0.5,node_na = 1,
                                dend_nav12=1*0.5,
                                na12name = 'na12annaTFHH',mut_name = 'na12annaTFHH',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  het_Vm,_,het_t,_ = simhet.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
  simhet.wtvsmut_stim_dvdt(wt_Vm=wt_Vm,wt_t=wt_t,het_Vm=None,het_t=None,sim_config=config,vs_amp=[0.5],stim_dur=500, fnpre=f'het')
  het_fi=simhet.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'het_FI', epochlabel='500ms')
  simhet.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx=f'het-')
  features = ef.get_features(sim=simhet, prefix=f'{root_path_out}/{path}/het', mut_name=f'{root_path_out}/{path}/het')
  allmutsefel = allmutsefel.append(features, ignore_index=True)

  ## Knockout ##
  simko = tf.Na12Model_TF(ais_nav12_fac=0,ais_nav16_fac=1.08*0.6,
                                nav12=0,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                                ais_ca = 43*0.5,ais_Kca = 0.25,
                                soma_na16=0.8,soma_na12=0,node_na = 1,
                                dend_nav12=0,
                                na12name = 'na12annaTFHH',mut_name = 'na12annaTFHH',na12mechs = ['na12','na12mut'],
                                na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                                plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
  ko_Vm,_,ko_t,_ = simko.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
  simko.wtvsmut_stim_dvdt(wt_Vm=wt_Vm,wt_t=wt_t,het_Vm=het_Vm,het_t=het_t,sim_config=config,vs_amp=[0.5],stim_dur=500, fnpre=f'ko')
  ko_fi=simko.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=het_fi,start=-0.4,end=1,nruns=140, fn=f'ko_FI', epochlabel='500ms')
  simko.make_currentscape_plot(amp=0.5, time1=50,time2=100,stim_start=30, sweep_len=200,pfx=f'ko-')
  features = ef.get_features(sim=simko, prefix=f'{root_path_out}/{path}/ko', mut_name=f'{root_path_out}/{path}/ko')
  allmutsefel = allmutsefel.append(features, ignore_index=True)

  allmutsefel.to_csv(f'{root_path_out}/{path}/EFEL_expression_at_{config_name}_052225.csv')
'''


'''
## Synth Mut plotting ##
for mutname,dict in bestsynthmuts012825.items():
  print(f"mutname is {mutname}")
  print(f"it's corresponding dictionary is {dict}")
  modify_dict_file(filenamemut,dict)


  try:
    ##Updated params to account for getting rid of factor in NeuronModelClass
    sim12 = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08*0.6,
                            nav12=1.1*1.1,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                            ais_ca = 43*0.5,ais_Kca = 0.25,
                            soma_na16=0.8,soma_na12=2.56,node_na = 1,
                            dend_nav12=1,
                            na12name = 'na12annaTFHH',mut_name = 'na12annaTFHH2mut',na12mechs = ['na12','na12mut'],
                            na16name = 'na16HH_TF',na16mut_name = 'na16HH_TF',na16mechs=['na16','na16mut'],params_folder = './params/',
                            plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
    # Vm12,_,t12,_ = sim12.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
    # sim12.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'{mutname}-FI', epochlabel='700ms')
    sim12.wtvsmut_stim_dvdt(wt_Vm=wt_Vm,wt_t=wt_t,sim_config=sim_config_soma,vs_amp=[0.5],stim_dur=500, fnpre=f'{mutname}')
    # sim12.make_currentscape_plot(amp=0.5, time1=100,time2=150,stim_start=100, sweep_len=200,pfx=f'currentscape/{mutname}')
  except ValueError as e:
    print(f'error in {mutname}')
    continue
'''





## 4 on 1 plotting ##
# dvdtwt=np.gradient(wt_Vm)/0.005

# Define the range of mut_idx values
mut_indices = [1,2,3,4,5,10,11,12,13]


# Create a colormap
cmap = cm.get_cmap('rainbow') # or any other colormap you prefer

for mut_idx in mut_indices:
  mut_name = f'mut{mut_idx}'

  # Create figure and axes OUTSIDE the variation loop
  fig1, axs1 = plt.subplots(figsize=(cm_to_in(8.5), cm_to_in(8)))

  # Plot the WT data ONCE per mut_idx
  # axs1.plot(wt_Vm[1:30000], dvdtwt[1:30000], color='black', alpha=0.8, linewidth=1, linestyle=':', label='WT')
  

  for variation_idx in range(1,5):
    variation=f'_{variation_idx}'
    full_key = mut_name+variation

    if full_key in bestsynthmuts012825:
      data = bestsynthmuts012825[full_key]
      modify_dict_file(filenamemut,data)
      print(f"mutname is {full_key}")
      print(f"it's corresponding dictionary is {data}")

      color = cmap(variation_idx/4)
      
      sim12 = tf.Na12Model_TF(ais_nav12_fac=5.76,ais_nav16_fac=1.08*0.6,
                              nav12=1.1*1.1,nav16=1.43*1.2, somaK=0.022, KP=3.9375, KT=5,
                              ais_ca = 43*0.5,ais_Kca = 0.25,
                              soma_na16=0.8,soma_na12=2.56,node_na = 1,
                              dend_nav12=1,
                              na12name = 'na12annaTFHH2',mut_name = 'na12annaTFHH2mut',na12mechs = ['na12','na12mut'],
                              na16name = 'na16HH_TF2',na16mut_name = 'na16HH_TF2',na16mechs=['na16','na16mut'],params_folder = './params/',
                              plots_folder = f'{root_path_out}/{path}', update=True, fac=None)
      # Vm12,_,t12,_ = sim12.get_stim_raw_data(stim_amp = 0.5,dt=0.005,rec_extra=False,stim_dur=500, sim_config = config) #stim_amp=0.5
      # dvdt1 = np.gradient(Vm12)/0.005
      # axs1.plot(Vm12[1:30000],dvdt1[1:30000],color=color, alpha=0.8, linewidth=1, label=full_key) # Added label here

      # sim12.plot_fi_curve_2line(wt_data=wt_fi,wt2_data=None,start=-0.4,end=1,nruns=140, fn=f'{full_key}-FI', epochlabel='500ms')
      # sim12.wtvsmut_stim_dvdt(wt_Vm=wt_Vm,wt_t=wt_t,sim_config=sim_config_soma,vs_amp=[0.5],stim_dur=500, fnpre=f'{full_key}')
      # sim12.make_currentscape_plot(amp=0.5, time1=90,time2=175,stim_start=30, sweep_len=200,pfx=f'{full_key}')
      try:
        features = ef.get_features(sim=sim12, prefix=f'{root_path_out}/{path}/{full_key}', mut_name=f'{root_path_out}/{path}/{full_key}')
        allmutsefel = allmutsefel.append(features, ignore_index=True)
      except Exception as e:
        print(f"Error in ef.get_features for {full_key}: {e}")
        continue

  # axs1.set_xlabel('Vm (mV)') #Setting labels and title
  # axs1.set_ylabel('dV/dt (mV/ms)')
  # axs1.set_title(f'{mut_name}')
  # # axs1.legend() #Adding legend
  # fig1.savefig(f'{root_path_out}/{path}/firstspike_dvdt4on1_{mut_name}.pdf') # Save figure AFTER plotting all variations
  # plt.close(fig1) #Close the figure to prevent memory issues    
allmutsefel.to_csv(f'{root_path_out}/{path}/EFEL_synthmuts_052825.csv')








